$NetBSD: patch-CVE-2013-4231,v 1.1 2013/08/15 14:58:46 drochner Exp $

see http://bugzilla.maptools.org/show_bug.cgi?id=2450

also fixes CVE-2013-4244
see https://bugzilla.redhat.com/show_bug.cgi?id=996468

--- tools/gif2tiff.c.orig	2010-12-15 03:52:53.000000000 +0000
+++ tools/gif2tiff.c
@@ -333,6 +333,10 @@ readraster(void)
     int status = 1;
 
     datasize = getc(infile);
+
+    if (datasize > 12)
+	return 0;
+
     clear = 1 << datasize;
     eoi = clear + 1;
     avail = clear + 2;
@@ -398,6 +402,10 @@ process(register int code, unsigned char
     }
 
     if (oldcode == -1) {
+	if (code >= clear) {
+	    fprintf(stderr, "bad input: code=%d is larger than clear=%d\n",code, clear);
+	    return 0;
+	}
 	*(*fill)++ = suffix[code];
 	firstchar = oldcode = code;
 	return 1;
