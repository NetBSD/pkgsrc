$NetBSD: patch-CVE-2018-17100,v 1.1.2.2 2018/10/29 14:49:32 bsiegert Exp $

Patch for CVE-2018-17100 from upstream git repo

--- tools/ppm2tiff.c.orig	2015-08-28 22:17:08.000000000 +0000
+++ tools/ppm2tiff.c	2018-10-09 17:20:10.068567016 +0000
@@ -72,16 +72,17 @@
 	exit(-2);
 }
 
+#define TIFF_SIZE_T_MAX ((size_t) ~ ((size_t)0))
+#define TIFF_TMSIZE_T_MAX (tmsize_t)(TIFF_SIZE_T_MAX >> 1)
+
 static tmsize_t
 multiply_ms(tmsize_t m1, tmsize_t m2)
 {
-	tmsize_t bytes = m1 * m2;
-
-	if (m1 && bytes / m1 != m2)
-		bytes = 0;
+	if( m1 == 0 || m2 > TIFF_TMSIZE_T_MAX / m1 )
+	    return 0;
 
-	return bytes;
-}
+	return m1 * m2;
+}  
 
 int
 main(int argc, char* argv[])
