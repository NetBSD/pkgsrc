--- ../../work/joe/b.c	Fri Jan 20 09:38:25 1995
+++ b.c	Thu Nov 25 18:17:59 1999
@@ -1928,7 +1928,7 @@
  if(s[0]=='!') pclose(f);
  else
 #endif
- if(zcmp(s,"-")) fclose(f);
+ if(zcmp(s,"-")) { if (fclose(f)) return error = -5; }
  else fflush(f);
 
  opnerr:;
--- ../../work/joe/ufile.c	Fri Jan 13 18:13:16 1995
+++ ufile.c	Thu Nov 25 17:25:47 1999
@@ -135,7 +135,7 @@
 int cp(from,to)
 char *from, *to;
  {
- int f, g, amnt;
+ int f, g, amnt, rc;
  struct stat sbuf;
 
 #ifdef HAVEUTIME
@@ -157,8 +157,8 @@
   }
  while((amnt=read(f,stdbuf,stdsiz))>0)
   if(amnt!=write(g,stdbuf,amnt)) break;
- close(f); close(g);
- if(amnt) return -1;
+ close(f); rc = close(g);
+ if(amnt || rc) return -1;
 
 #ifdef HAVEUTIME
 #ifdef NeXT
