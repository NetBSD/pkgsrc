$NetBSD: patch-aa,v 1.9 1998/12/01 02:47:19 tv Exp $

--- Configure.orig	Fri Oct  3 13:57:39 1997
+++ Configure	Mon Nov 30 20:48:38 1998
@@ -65,7 +65,7 @@
 fi
 
 : Proper PATH setting
-paths='/bin /usr/bin /usr/local/bin /usr/ucb /usr/local /usr/lbin'
+paths='/bin /usr/bin ${PREFIX}/bin /usr/ucb ${PREFIX} /usr/lbin'
 paths="$paths /opt/bin /opt/local/bin /opt/local /opt/lbin"
 paths="$paths /usr/5bin /etc /usr/gnu/bin /usr/new /usr/new/bin /usr/nbin"
 paths="$paths /opt/gnu/bin /opt/new /opt/new/bin /opt/nbin"
@@ -92,10 +92,10 @@
 esac
 
 : Sanity checks
-if test ! -t 0; then
-	echo "Say 'sh $me', not 'sh <$me'"
-	exit 1
-fi
+# if test ! -t 0; then
+# 	echo "Say 'sh $me', not 'sh <$me'"
+# 	exit 1
+# fi
 
 : Test and see if we are running under ksh, either blatantly or in disguise.
 if (PATH=.; alias -x) >/dev/null 2>&1; then
@@ -725,7 +725,7 @@
 archobjs=''
 : Possible local include directories to search.
 : Set locincpth to "" in a hint file to defeat local include searches.
-locincpth="/usr/local/include /opt/local/include /usr/gnu/include"
+locincpth="${PREFIX}/include /opt/local/include /usr/gnu/include"
 locincpth="$locincpth /opt/gnu/include /usr/GNU/include /opt/GNU/include"
 :
 : no include file wanted by default
@@ -735,14 +735,14 @@
 xlibpth='/usr/lib/386 /lib/386'
 
 : Possible local library directories to search.
-loclibpth="/usr/local/lib /opt/local/lib /usr/gnu/lib"
+loclibpth="${PREFIX}/lib /opt/local/lib /usr/gnu/lib"
 loclibpth="$loclibpth /opt/gnu/lib /usr/GNU/lib /opt/GNU/lib"
 
 : general looking path for locating libraries
 glibpth="/shlib /usr/shlib /usr/lib/pa1.1 /usr/lib/large"
 glibpth="$glibpth /lib /usr/lib $xlibpth"
 glibpth="$glibpth /lib/large /usr/lib/small /lib/small"
-glibpth="$glibpth /usr/ccs/lib /usr/ucblib /usr/local/lib"
+glibpth="$glibpth /usr/ccs/lib /usr/ucblib ${PREFIX}/lib"
 
 : Private path used by Configure to find libraries.  Its value
 : is prepended to libpth. This variable takes care of special
@@ -753,7 +753,8 @@
 defvoidused=15
 
 : List of libraries we want.
-libswanted='sfio net socket inet nsl nm ndbm gdbm dbm db malloc dl'
+# libswanted='sfio net socket inet nsl nm ndbm gdbm dbm db malloc dl'
+libswanted='sfio socket inet nsl nm ndbm gdbm dbm db malloc dl'
 libswanted="$libswanted dld ld sun m c cposix posix ndir dir crypt"
 libswanted="$libswanted ucb bsd BSD PW x"
 : We probably want to search /usr/shlib before most other libraries.
@@ -2365,7 +2366,7 @@
 : determine root of directory hierarchy where package will be installed.
 case "$prefix" in
 '')
-	dflt=`./loc . /usr/local /usr/local /local /opt /usr`
+	dflt=`./loc . ${PREFIX} ${PREFIX} /local /opt /usr`
 	;;
 *)
 	dflt="$prefix"
@@ -2375,10 +2376,10 @@
 
 By default, $package will be installed in $dflt/bin, manual
 pages under $dflt/man, etc..., i.e. with $dflt as prefix for
-all installation directories. Typically set to /usr/local, but you
+all installation directories. Typically set to ${PREFIX}, but you
 may choose /usr if you wish to install $package among your system
 binaries. If you wish to have binaries under /bin but manual pages
-under /usr/local/man, that's ok: you will be prompted separately
+under ${PREFIX}/man, that's ok: you will be prompted separately
 for each of the installation directories, the prefix being only used
 to set the defaults.
 
@@ -2426,7 +2427,7 @@
 esac'
 
 : determine where private library files go
-: Usual default is /usr/local/lib/perl5.  Also allow things like 
+: Usual default is ${PREFIX}/lib/perl5.  Also allow things like 
 : /opt/perl/lib, since /opt/perl/lib/perl5 would be redundant.
 case "$prefix" in
 *perl*) set dflt privlib lib ;;
@@ -2501,7 +2502,7 @@
 case "$archlib" in
 '')
     case "$privlib" in
-    '')	dflt=`./loc . "." $prefixexp/lib /usr/local/lib /usr/lib /lib`
+    '')	dflt=`./loc . "." $prefixexp/lib ${PREFIX}/lib /usr/lib /lib`
 	set dflt
 	eval $prefixup
 	;;
@@ -2986,8 +2987,8 @@
 	syspath='/usr/man/man1 /usr/man/mann /usr/man/manl /usr/man/local/man1'
 	syspath="$syspath /usr/man/u_man/man1 /usr/share/man/man1"
 	syspath="$syspath /usr/catman/u_man/man1 /usr/man/l_man/man1"
-	syspath="$syspath /usr/local/man/u_man/man1 /usr/local/man/l_man/man1"
-	syspath="$syspath /usr/man/man.L /local/man/man1 /usr/local/man/man1"
+	syspath="$syspath ${PREFIX}/man/u_man/man1 ${PREFIX}/man/l_man/man1"
+	syspath="$syspath /usr/man/man.L /local/man/man1 ${PREFIX}/man/man1"
 	sysman=`./loc . /usr/man/man1 $syspath`
 	;;
 esac
@@ -3268,7 +3269,7 @@
 : Set private lib path
 case "$plibpth" in
 '') if ./mips; then
-		plibpth="$incpath/usr/lib /usr/local/lib /usr/ccs/lib"
+		plibpth="$incpath/usr/lib ${PREFIX}/lib /usr/ccs/lib"
 	fi;;
 esac
 case "$libpth" in
@@ -4747,10 +4748,10 @@
 	aix)
 		# We'll set it in Makefile.SH...
 		;;
-	solaris|netbsd)
+	solaris)
 		xxx="-R $shrpdir"
 		;;
-	freebsd)
+	freebsd|netbsd)
 		xxx="-Wl,-R$shrpdir"
 		;;
 	linux|irix*|dec_osf)
@@ -4965,8 +4966,8 @@
 esac
 
 echo "If you don't want the manual sources installed, answer 'none'."
-: We dont use /usr/local/man/man3 because some man programs will
-: only show the /usr/local/man/man3 contents, and not the system ones,
+: We dont use ${PREFIX}/man/man3 because some man programs will
+: only show the ${PREFIX}/man/man3 contents, and not the system ones,
 : thus man less will show the perl module less.pm, but not the system
 : less command.  We might also conflict with TCL man pages.
 : However, something like /opt/perl/man/man3 is fine.
@@ -5413,7 +5414,7 @@
 	: guess some guesses
 	$test -d /usr/share/scripts && dflt=/usr/share/scripts
 	$test -d /usr/share/bin && dflt=/usr/share/bin
-	$test -d /usr/local/script && dflt=/usr/local/script
+	$test -d ${PREFIX}/script && dflt=${PREFIX}/script
 	$test -d $prefixexp/script && dflt=$prefixexp/script
 	set dflt
 	eval $prefixup
@@ -8726,7 +8727,7 @@
 	case "$ranlib" in
 	:) ranlib='';;
 	'')
-		ranlib=`./loc ranlib X /usr/bin /bin /usr/local/bin`
+		ranlib=`./loc ranlib X /usr/bin /bin ${PREFIX}/bin`
 		$test -f $ranlib || ranlib=''
 		;;
 	esac
