# $NetBSD: Makefile,v 1.3 2004/10/05 22:09:23 tv Exp $

DISTNAME=	jre-1_5_0-linux-i586
PKGNAME=	sun-jre15-5.0
PKGREVISION=	1
MASTER_SITES=	# empty

COMMENT=	Sun's Java(tm) 2 Runtime Environment 1.5.0

SHORT=		JRE

WRKSRC=		${WRKDIR}/jre1.5.0
USE_PKGINSTALL=	yes
JAVA_WRAPPERS=	java javaws keytool orbd policytool rmid rmiregistry \
		servertool tnameserv
OWN_DIRS=	${JAVA_HOME}
OWN_DIRS+=	${JAVA_HOME}/lib
OWN_DIRS+=	${JAVA_HOME}/lib/applet
OWN_DIRS+=	${JAVA_HOME}/lib/images
OWN_DIRS+=	${JAVA_HOME}/lib/images/cursors
OWN_DIRS+=	${JAVA_HOME}/lib/security
SUPPORT_FILES=	# empty
.sinclude "sfiles.mk"
.for FILE in ${SFILES}
SUPPORT_FILES+=	${JAVA_HOME}/lib/${FILE}.default ${JAVA_HOME}/lib/${FILE}
.endfor

.include "../../mk/bsd.prefs.mk"

#BUILD_DEFS+=		SUN_JRE15_USE_JCE	# does not exist (yet?)
#PLIST_SRC=      	${WRKDIR}/PLIST

#.if !empty(SUN_JRE15_USE_JCE:M[Yy][Ee][Ss])
#DISTFILES=	${DISTNAME}${EXTRACT_SUFX} jce_policy-1_5_0.zip
#.endif

do-configure:
	cd ${WRKSRC}/lib; for file in ${SFILES}; do			\
		${MV} -f $$file $$file.default;				\
	done
#.if !empty(SUN_JRE15_USE_JCE:M[Yy][Ee][Ss])
#	cd ${WRKDIR}/jce ; pax -rw -pe -v . ${WRKSRC}/lib/security
#	${SED} 's/@SUN_JRE15_USE_JCE@//' ${PKGDIR}/PLIST > ${PLIST_SRC}
#.else
#	${SED} '/@SUN_JRE15_USE_JCE@/d' ${PKGDIR}/PLIST > ${PLIST_SRC}
#.endif

#
# re-create sfiles.mk from properties and config files
#
makesfiles:
	${ECHO} >  sfiles.mk '#	$$Net''BSD$$'
	${ECHO} >> sfiles.mk '#'
	${ECHO} >> sfiles.mk '# Created with "make makesfiles"'
	${ECHO} >> sfiles.mk '# Do not edit this file manually!'
	${ECHO} >> sfiles.mk '#'
	cd ${WRKSRC}/lib && ${FIND} * -name \*.properties\*		\
		-o -name \*.cfg -o -name fontconfig.\*			\
		-o -name \*.security |					\
	${SED} 's/^/SFILES+=	/' >>../../../sfiles.mk

.include "../../lang/sun-jre15/Makefile.common"
