$NetBSD: patch-aq,v 1.1 2005/01/23 17:33:19 taca Exp $

--- lib/webrick/httpauth/digestauth.rb.orig	2004-12-18 16:19:46.000000000 +0900
+++ lib/webrick/httpauth/digestauth.rb
@@ -174,11 +174,11 @@ module WEBrick
 
         if auth_req['qop'] == "auth" || auth_req['qop'] == nil
           ha2 = hexdigest(req.request_method, auth_req['uri'])
-          ha2_res = digest("", auth_req['uri'])
+          ha2_res = hexdigest("", auth_req['uri'])
         elsif auth_req['qop'] == "auth-int"
           ha2 = hexdigest(req.request_method, auth_req['uri'],
                           hexdigest(req.body))
-          ha2_res = digest("", auth_req['uri'], hexdigest(req.body))
+          ha2_res = hexdigest("", auth_req['uri'], hexdigest(res.body))
         end
 
         if auth_req['qop'] == "auth" || auth_req['qop'] == "auth-int"
@@ -331,9 +331,6 @@ module WEBrick
         @h.hexdigest(args.join(":"))
       end
 
-      def digest(*args)
-        @h.digest(args.join(":"))
-      end
     end
 
     class ProxyDigestAuth < DigestAuth
