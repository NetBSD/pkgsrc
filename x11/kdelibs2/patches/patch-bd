$NetBSD: patch-bd,v 1.1 2001/10/15 22:46:25 skrll Exp $

--- kio/kded/Makefile.am.orig	Sun Jul 29 05:55:39 2001
+++ kio/kded/Makefile.am
@@ -19,32 +19,40 @@
 
 INCLUDES= -I$(srcdir)/.. -I$(top_srcdir) $(all_includes)
 
-lib_LTLIBRARIES = kded.la kbuildsycoca.la
+lib_LTLIBRARIES = libkded_main.la kded.la libkbuildsycoca_main.la kbuildsycoca.la
 
-kded_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kded_la_LIBADD = $(LIB_KSYCOCA)
-kded_la_SOURCES = kded.cpp kbuildservicetypefactory.cpp \
+libkded_main_la_LDFLAGS = $(all_libraries)
+libkded_main_la_LIBADD = $(LIB_KSYCOCA)
+libkded_main_la_SOURCES = kded.cpp kbuildservicetypefactory.cpp \
 			kbuildservicefactory.cpp \
 			kbuildservicegroupfactory.cpp kdedmodule.cpp
 
-kbuildsycoca_la_LDFLAGS = $(all_libraries) -module -avoid-version
-kbuildsycoca_la_LIBADD = $(LIB_KSYCOCA)
-kbuildsycoca_la_SOURCES = kbuildsycoca.cpp kbuildservicetypefactory.cpp \
+kded_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kded_la_LIBADD = libkded_main.la
+kded_la_SOURCES = kded_main.cpp
+
+libkbuildsycoca_main_la_LDFLAGS = $(all_libraries)
+libkbuildsycoca_main_la_LIBADD = $(LIB_KSYCOCA)
+libkbuildsycoca_main_la_SOURCES = kbuildsycoca.cpp kbuildservicetypefactory.cpp \
 				kbuildservicefactory.cpp \
 				kbuildservicegroupfactory.cpp \
 				kbuildimageiofactory.cpp \
 				kbuildprotocolinfofactory.cpp \
 				kctimefactory.cpp
 
+kbuildsycoca_la_LDFLAGS = $(all_libraries) -module -avoid-version
+kbuildsycoca_la_LIBADD = libkbuildsycoca_main.la
+kbuildsycoca_la_SOURCES = kbuildsycoca_main.cpp
+
 bin_PROGRAMS = kded kbuildsycoca kdontchangethehostname
 
 kded_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kded_LDADD = $(LIB_KSYCOCA) kded.la
-kded_SOURCES = dummy.cpp
+kded_LDADD = $(LIB_KSYCOCA) libkded_main.la
+kded_SOURCES = kded_main.cpp
 
 kbuildsycoca_LDFLAGS = $(all_libraries) $(KDE_RPATH)
-kbuildsycoca_LDADD = $(LIB_KSYCOCA) kbuildsycoca.la
-kbuildsycoca_SOURCES = dummy.cpp
+kbuildsycoca_LDADD = $(LIB_KSYCOCA) libkbuildsycoca_main.la
+kbuildsycoca_SOURCES = kbuildsycoca_main.cpp
 
 kdontchangethehostname_LDFLAGS = $(all_libraries) $(KDE_RPATH)
 kdontchangethehostname_LDADD =  $(LIB_KDECORE)
@@ -61,6 +69,3 @@
 
 servicetype_DATA = kdedmodule.desktop
 servicetypedir = $(kde_servicetypesdir)
-
-dummy.cpp:
-	echo > dummy.cpp
