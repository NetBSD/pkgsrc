#! /bin/sh
#
# $NetBSD: mkbootstrapkit,v 1.8 2007/01/28 01:40:49 jschauma Exp $
#
# Usage: mkbootstrapkit [kitdir]
#
# Make a source bootstrap kit.  By default, the "kitdir" is
# ${TMPDIR}/bootstrap-kit-<today>, the resulting archive will extract
# a directory tree rooted in "bootstrap-kit-<today>".

date=`date +%Y%m%d`
kitdir=${1:-${TMPDIR:=/tmp}/bootstrap-kit-${date}}
kitfile=${1:-${TMPDIR:=/tmp}/bootstrap-kit-${date}.tgz}

bootstrapdir=`pwd`
pkgsrcdir=`dirname $bootstrapdir`

echo "Creating $kitdir."
rm -rf $kitdir
mkdir -p $kitdir
cd $pkgsrcdir
for dir in \
	archivers/pax \
	bootstrap \
	devel/bmake \
	lang/nawk \
	mk \
	net/tnftp \
	pkgtools/bootstrap-extras \
	pkgtools/bootstrap-mk-files \
	pkgtools/digest \
	pkgtools/libnbcompat \
	pkgtools/mtree \
	pkgtools/pax \
	pkgtools/pkg_install \
	pkgtools/pkgmanpages \
	pkgtools/tnftp \
	sysutils/install-sh \
	textproc/nbsed
do
	echo "Copying $dir."
	tar hcf - $dir | ( cd $kitdir; tar xf - )
done

echo "Archiving to $kitfile."
rm -f $kitfile
cd `dirname $kitdir` && tar cpf - `basename $kitdir` | gzip -c > $kitfile 

echo "Removing $kitdir."
rm -rf $kitdir
