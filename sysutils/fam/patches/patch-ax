$NetBSD: patch-ax,v 1.1 2002/10/02 22:31:00 dillo Exp $

--- configure.orig	Thu Oct  3 00:27:08 2002
+++ configure
@@ -1881,6 +1881,43 @@ fi
 
 
 
+ac_safe=`echo "mntent.h" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for mntent.h""... $ac_c" 1>&6
+echo "configure:1887: checking for mntent.h" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1892 "configure"
+#include "confdefs.h"
+#include <mntent.h>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1897: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
+fi
+rm -f conftest*
+fi
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  cat >> confdefs.h <<\EOF
+#define HAVE_MNTENT_H 1
+EOF
+
+else
+  echo "$ac_t""no" 1>&6
+fi
+
+
 if test `uname` = 'IRIX' || test `uname` = 'IRIX64'; then
     have_imon=yes
     cat >> confdefs.h <<\EOF
@@ -2382,129 +2419,8 @@ fi
 
 
 
-    echo $ac_n "checking mntent.h for MNTTYPE_NFS""... $ac_c" 1>&6
-echo "configure:2387: checking mntent.h for MNTTYPE_NFS" >&5
-    cat > conftest.$ac_ext <<EOF
-#line 2389 "configure"
-#include "confdefs.h"
-#include <mntent.h>
-int main() {
-const char *foo = MNTTYPE_NFS;
-; return 0; }
-EOF
-if { (eval echo configure:2396: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  fam_have_decl_in_mntent=yes
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  fam_have_decl_in_mntent=no
-fi
-rm -f conftest*
-    echo "$ac_t""$fam_have_decl_in_mntent" 1>&6
-    if test "$fam_have_decl_in_mntent" = "yes"; then
-	:
-    else	
-	{ echo "configure: error: Didn't find MNTTYPE_NFS in mntent.h" 1>&2; exit 1; }
-    fi
-
-
-    echo $ac_n "checking mntent.h for MNTTYPE_NFS2""... $ac_c" 1>&6
-echo "configure:2415: checking mntent.h for MNTTYPE_NFS2" >&5
-    cat > conftest.$ac_ext <<EOF
-#line 2417 "configure"
-#include "confdefs.h"
-#include <mntent.h>
-int main() {
-const char *foo = MNTTYPE_NFS2;
-; return 0; }
-EOF
-if { (eval echo configure:2424: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  fam_have_decl_in_mntent=yes
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  fam_have_decl_in_mntent=no
-fi
-rm -f conftest*
-    echo "$ac_t""$fam_have_decl_in_mntent" 1>&6
-    if test "$fam_have_decl_in_mntent" = "yes"; then
-	cat >> confdefs.h <<\EOF
-#define HAVE_MNTTYPE_NFS2 1
-EOF
-
-    else	
-	:
-    fi
-
-
-    echo $ac_n "checking mntent.h for MNTTYPE_NFS3""... $ac_c" 1>&6
-echo "configure:2446: checking mntent.h for MNTTYPE_NFS3" >&5
-    cat > conftest.$ac_ext <<EOF
-#line 2448 "configure"
-#include "confdefs.h"
-#include <mntent.h>
-int main() {
-const char *foo = MNTTYPE_NFS3;
-; return 0; }
-EOF
-if { (eval echo configure:2455: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  fam_have_decl_in_mntent=yes
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  fam_have_decl_in_mntent=no
-fi
-rm -f conftest*
-    echo "$ac_t""$fam_have_decl_in_mntent" 1>&6
-    if test "$fam_have_decl_in_mntent" = "yes"; then
-	cat >> confdefs.h <<\EOF
-#define HAVE_MNTTYPE_NFS3 1
-EOF
-
-    else	
-	:
-    fi
-
-
-    echo $ac_n "checking mntent.h for MNTTYPE_CACHEFS""... $ac_c" 1>&6
-echo "configure:2477: checking mntent.h for MNTTYPE_CACHEFS" >&5
-    cat > conftest.$ac_ext <<EOF
-#line 2479 "configure"
-#include "confdefs.h"
-#include <mntent.h>
-int main() {
-const char *foo = MNTTYPE_CACHEFS;
-; return 0; }
-EOF
-if { (eval echo configure:2486: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  fam_have_decl_in_mntent=yes
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  fam_have_decl_in_mntent=no
-fi
-rm -f conftest*
-    echo "$ac_t""$fam_have_decl_in_mntent" 1>&6
-    if test "$fam_have_decl_in_mntent" = "yes"; then
-	cat >> confdefs.h <<\EOF
-#define HAVE_MNTTYPE_CACHEFS 1
-EOF
-
-    else	
-	:
-    fi
-
-
 echo $ac_n "checking netinet/in.h for bindresvport()""... $ac_c" 1>&6
-echo "configure:2508: checking netinet/in.h for bindresvport()" >&5
+echo "configure:2424: checking netinet/in.h for bindresvport()" >&5
 if eval "test \"`echo '$''{'fam_cv_bindresvport_in_in_h'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
