$NetBSD: patch-aq,v 1.3 2004/04/07 19:53:27 reed Exp $
SECURITY [CAN-2003-0020]: escape arbitrary data before writing into the errorlog

--- src/include/httpd.h.orig	2004-04-07 12:24:10.967724616 -0700
+++ src/include/httpd.h
@@ -1072,6 +1072,8 @@ API_EXPORT(char *) ap_escape_html(pool *
 API_EXPORT(char *) ap_construct_server(pool *p, const char *hostname,
 				    unsigned port, const request_rec *r);
 API_EXPORT(char *) ap_escape_logitem(pool *p, const char *str);
+API_EXPORT(size_t) ap_escape_errorlog_item(char *dest, const char *source,
+                                           size_t buflen);
 API_EXPORT(char *) ap_escape_shell_cmd(pool *p, const char *s);
 
 API_EXPORT(int) ap_count_dirs(const char *path);
