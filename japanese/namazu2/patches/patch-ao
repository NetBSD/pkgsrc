$NetBSD: patch-ao,v 1.3 2002/01/10 17:54:32 taca Exp $

--- filter/powerpoint.pl.orig	Tue Dec 26 13:59:01 2000
+++ filter/powerpoint.pl
@@ -25,6 +25,7 @@
 
 package powerpoint;
 use strict;
+use File::Basename;
 use File::Copy;
 require 'util.pl';
 require 'gfilter.pl';
@@ -32,15 +33,17 @@
 
 my $pptconvpath  = undef;
 my $utfconvpath = undef;
+my $pptconvname = undef;
 
 sub mediatype() {
     return ('application/powerpoint');
 }
 
 sub status() {
-	$pptconvpath = util::checkcmd('pptHtml');
+	$pptconvpath = util::checkcmd('ppthtml') || util::checkcmd('pptHtml');
 #	return 'no' unless defined $pptconvpath
 	if (defined $pptconvpath) {
+	    $pptconvname = basename($pptconvpath);
 		if (!util::islang("ja")) {
 			return 'yes';
 		} else {
@@ -82,7 +85,7 @@
       = @_;
     my $err = undef;
 
-    if (util::checkcmd('pptHtml')) {
+    if ($pptconvname =~ /ppthtml/i) {
     $err = filter_ppt($orig_cfile, $cont, $weighted_str, $headings, $fields);
     } else {
     $err = filter_doccat($orig_cfile, $cont, $weighted_str, $headings, $fields);
