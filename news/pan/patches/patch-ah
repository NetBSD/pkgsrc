$NetBSD: patch-ah,v 1.1 2003/04/15 10:28:46 wiz Exp $

--- pan/sockets.c.orig	Wed Feb 12 19:37:43 2003
+++ pan/sockets.c	Sun Mar 30 21:33:25 2003
@@ -86,6 +86,9 @@
                 int              port)
 {
 	PanSocket * sock;
+#	ifdef SIGPIPE
+	struct sigaction sig;
+#	endif
 
 	/* sanity clause */
 	g_return_val_if_fail (is_nonempty_string (server_name), NULL);
@@ -94,7 +97,10 @@
 
 	/* needed on Unix */
 #	ifdef SIGPIPE
-	sigignore (SIGPIPE);
+	sig.sa_handler = SIG_IGN;
+	sig.sa_flags = 0;
+	sigprocmask(0, NULL, &sig.sa_mask);
+	sigaction(SIGPIPE, &sig, NULL);
 #	endif
 
 	/* create the socket */
