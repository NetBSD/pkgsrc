$NetBSD: patch-bd,v 1.1 2002/08/03 12:27:21 itojun Exp $

diff -u1 bgpd/bgp_vty.c /home/itojun/work/zebra/zebra/bgpd/bgp_vty.c
--- bgpd/bgp_vty.c	Mon Jul  8 22:31:01 2002
+++ /home/itojun/work/zebra/zebra/bgpd/bgp_vty.c	Sat Aug  3 21:05:54 2002
@@ -98,8 +98,2 @@
 
-  if (peer_address_self_check (&su))
-    {
-      vty_out (vty, "%% Cannot configure the local system as neighbor%s", VTY_NEWLINE);
-      return NULL;
-    }
-
   peer = peer_lookup (bgp, &su);
@@ -128,8 +122,2 @@
     {
-      if (peer_address_self_check (&su))
-	{
-	  vty_out (vty, "%% Cannot configure the local system as neighbor%s", VTY_NEWLINE);
-	  return NULL;
-	}
-
       peer = peer_lookup (bgp, &su);
@@ -1123,3 +1111,4 @@
     {
-      vty_out (vty, "%% Cannot configure the local system as neighbor%s", VTY_NEWLINE);
+      vty_out (vty, "%% Can not configure the local system as neighbor%s",
+	       VTY_NEWLINE);
       return CMD_WARNING;
@@ -1200,9 +1189,2 @@
     {
-      if (peer_address_self_check (&su))
-	{
-	  vty_out (vty, "%% Cannot configure the local system as neighbor%s",
-		   VTY_NEWLINE);
-	  return CMD_WARNING;
-	}
-
       peer = peer_lookup (vty->index, &su);
@@ -1410,2 +1392,9 @@
       vty_out (vty, "%% Configure the peer-group first%s", VTY_NEWLINE);
+      return CMD_WARNING;
+    }
+
+  if (peer_address_self_check (&su))
+    {
+      vty_out (vty, "%% Can not configure the local system as neighbor%s",
+	       VTY_NEWLINE);
       return CMD_WARNING;
