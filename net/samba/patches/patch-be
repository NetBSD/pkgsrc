$NetBSD: patch-be,v 1.1 2005/11/14 08:05:28 jlam Exp $

--- nmbd/nmbd_winsserver.c.orig	2005-10-12 13:03:37.000000000 -0400
+++ nmbd/nmbd_winsserver.c
@@ -234,7 +234,7 @@ BOOL initialise_wins(void)
 
 	add_samba_names_to_subnet(wins_server_subnet);
 
-	if((fp = x_fopen(lock_path(WINS_LIST),O_RDONLY,0)) == NULL) {
+	if((fp = x_fopen(state_path(WINS_LIST),O_RDONLY,0)) == NULL) {
 		DEBUG(2,("initialise_wins: Can't open wins database file %s. Error was %s\n",
 			WINS_LIST, strerror(errno) ));
 		return True;
@@ -1810,7 +1810,7 @@ void wins_write_database(BOOL background
 		}
 	}
 
-	slprintf(fname,sizeof(fname)-1,"%s/%s", lp_lockdir(), WINS_LIST);
+	pstrcpy(fname, state_path(WINS_LIST));
 	all_string_sub(fname,"//", "/", 0);
 	slprintf(fnamenew,sizeof(fnamenew)-1,"%s.%u", fname, (unsigned int)sys_getpid());
 
