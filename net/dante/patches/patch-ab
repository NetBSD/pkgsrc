$NetBSD: patch-ab,v 1.8 2006/05/26 08:50:13 adam Exp $

--- configure.orig	2006-01-16 12:49:45.000000000 +0100
+++ configure
@@ -19251,7 +19251,6 @@ else
 echo "${ECHO_T}no" >&6
     #autoconf_compflags is set to "-g -O2" with GCC
     #override CFLAGS when running configure to avoid this
-    CFLAGS="$CFLAGS $autoconf_compflags"
 fi
 
 #-Wall ?
@@ -25124,8 +25123,13 @@ cat >>conftest.$ac_ext <<_ACEOF
 #include <netdb.h>
 #include <unistd.h>
 
+#if defined(__DragonFly__)
 struct hostent *
 gethostbyaddr( const char *, int, int
+#else
+struct hostent *
+gethostbyaddr( const char *, socklen_t, int
+#endif
 );
 int
 main ()
@@ -25166,9 +25170,18 @@ cat >>confdefs.h <<_ACEOF
 #define HAVE_PROT_GETHOSTBYADDR_1 const char *
 _ACEOF
 
-cat >>confdefs.h <<_ACEOF
+case "$host_os" in
+dragonfly*)
+	cat >>confdefs.h <<_ACEOF
 #define HAVE_PROT_GETHOSTBYADDR_2 int
 _ACEOF
+;;
+*)
+	cat >>confdefs.h <<_ACEOF
+#define HAVE_PROT_GETHOSTBYADDR_2 socklen_t
+_ACEOF
+;;
+esac
 
 cat >>confdefs.h <<_ACEOF
 #define HAVE_PROT_GETHOSTBYADDR_3 int
