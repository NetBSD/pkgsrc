$NetBSD: patch-aa,v 1.7 2000/07/03 11:31:04 mjl Exp $

*** Configure.orig	Mon Jan 17 17:44:18 2000
--- Configure	Mon Jul  3 12:23:05 2000
***************
*** 258,275 ****
  
  #---------------------------------------------------------------------------
  
! if($have_old && !$opt_d)
!  {
!   $msg = <<EDQ;
! 
! Ah, I see you already have installed libnet before.
! 
! Do you want to modify/update your configuration (y|n) ?
! EDQ
! 
!  $opt_d = 1
! 	unless get_bool($msg,0);
!  }
  
  #---------------------------------------------------------------------------
  
--- 258,276 ----
  
  #---------------------------------------------------------------------------
  
! #if($have_old && !$opt_d)
! # {
! #  $msg = <<EDQ;
! #
! #Ah, I see you already have installed libnet before.
! #
! #Do you want to modify/update your configuration (y|n) ?
! #EDQ
! #
! # $opt_d = 1
! #	unless get_bool($msg,0);
! # }
! $opt_d = 0;
  
  #---------------------------------------------------------------------------
  
***************
*** 286,292 ****
  Do you want me to perform hostname lookups (y|n) ?
  EDQ
  
! $cfg{'test_exist'} = get_bool($msg, $oldcfg{'test_exist'});
  
  print <<EDQ unless $cfg{'test_exist'};
  
--- 287,293 ----
  Do you want me to perform hostname lookups (y|n) ?
  EDQ
  
! $cfg{'test_exist'} = 1;
  
  print <<EDQ unless $cfg{'test_exist'};
  
***************
*** 301,321 ****
  
  #---------------------------------------------------------------------------
  
! print <<EDQ;
! 
! The following questions all require a list of host names, separated
! with spaces. If you do not have a host available for any of the
! services, then enter a single space, followed by <CR>. To accept the
! default, hit <CR>
! 
! EDQ
  
  $msg = 'Enter a list of available NNTP hosts :';
  
  $def = $oldcfg{'nntp_hosts'} ||
  	[ default_hostname($ENV{NNTPSERVER},$ENV{NEWSHOST},'news') ];
  
! $cfg{'nntp_hosts'} = get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 302,322 ----
  
  #---------------------------------------------------------------------------
  
! # print <<EDQ;
! # 
! # The following questions all require a list of host names, separated
! # with spaces. If you do not have a host available for any of the
! # services, then enter a single space, followed by <CR>. To accept the
! # default, hit <CR>
! # 
! # EDQ
  
  $msg = 'Enter a list of available NNTP hosts :';
  
  $def = $oldcfg{'nntp_hosts'} ||
  	[ default_hostname($ENV{NNTPSERVER},$ENV{NEWSHOST},'news') ];
  
! $cfg{'nntp_hosts'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 324,330 ****
  $def = $oldcfg{'smtp_hosts'} ||
  	[ default_hostname(split(/:/,$ENV{SMTPHOSTS} || ""), 'mailhost') ];
  
! $cfg{'smtp_hosts'} = get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 325,331 ----
  $def = $oldcfg{'smtp_hosts'} ||
  	[ default_hostname(split(/:/,$ENV{SMTPHOSTS} || ""), 'mailhost') ];
  
! $cfg{'smtp_hosts'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 332,338 ****
  
  $def = $oldcfg{'pop3_hosts'} || [];
  
! $cfg{'pop3_hosts'} = get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 333,339 ----
  
  $def = $oldcfg{'pop3_hosts'} || [];
  
! $cfg{'pop3_hosts'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 340,346 ****
  
  $def = $oldcfg{'snpp_hosts'} || [];
  
! $cfg{'snpp_hosts'} = get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 341,347 ----
  
  $def = $oldcfg{'snpp_hosts'} || [];
  
! $cfg{'snpp_hosts'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 349,355 ****
  $def = $oldcfg{'ph_hosts'} ||
  	[ default_hostname('dirserv') ];
  
! $cfg{'ph_hosts'}   =  get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 350,356 ----
  $def = $oldcfg{'ph_hosts'} ||
  	[ default_hostname('dirserv') ];
  
! $cfg{'ph_hosts'}   =  $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 357,363 ****
  
  $def = $oldcfg{'time_hosts'} || [];
  
! $cfg{'time_hosts'} = get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 358,364 ----
  
  $def = $oldcfg{'time_hosts'} || [];
  
! $cfg{'time_hosts'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 365,371 ****
  
  $def = $oldcfg{'daytime_hosts'} || $oldcfg{'time_hosts'};
  
! $cfg{'daytime_hosts'} = get_host_list($msg,$def);
  
  #---------------------------------------------------------------------------
  
--- 366,372 ----
  
  $def = $oldcfg{'daytime_hosts'} || $oldcfg{'time_hosts'};
  
! $cfg{'daytime_hosts'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 378,384 ****
  (y|n) ?
  EDQ
  
! if(get_bool($msg,0)) {
  
    $msg = <<'EDQ';
  What series of FTP commands do you need to send to your
--- 379,386 ----
  (y|n) ?
  EDQ
  
! # XXX Should probably honor USE_SOCKS? --mjl
! if(0 && get_bool($msg,0)) {
  
    $msg = <<'EDQ';
  What series of FTP commands do you need to send to your
***************
*** 489,503 ****
  
  #---------------------------------------------------------------------------
  
! print <<EDQ;
! 
! Normally when FTP needs a data connection the client tells the server
! a port to connect to, and the server initiates a connection to the client.
! 
! Some setups, in particular firewall setups, can/do not work using this
! protocol. In these situations the client must make the connection to the
! server, this is called a passive transfer.
! EDQ
  
  if (defined $cfg{'ftp_firewall'}) {
    $msg = "\nShould all FTP connections via a firewall/proxy be passive (y|n) ?";
--- 491,505 ----
  
  #---------------------------------------------------------------------------
  
! # print <<EDQ;
! # 
! # Normally when FTP needs a data connection the client tells the server
! # a port to connect to, and the server initiates a connection to the client.
! # 
! # Some setups, in particular firewall setups, can/do not work using this
! # protocol. In these situations the client must make the connection to the
! # server, this is called a passive transfer.
! # EDQ
  
  if (defined $cfg{'ftp_firewall'}) {
    $msg = "\nShould all FTP connections via a firewall/proxy be passive (y|n) ?";
***************
*** 515,530 ****
  
  $def = $oldcfg{'ftp_int_passive'} || 0;
  
! $cfg{'ftp_int_passive'} = get_bool($msg,$def);
  
  
  #---------------------------------------------------------------------------
  
! $def = $oldcfg{'inet_domain'} || $ENV{LOCALDOMAIN};
  
! $ans = Prompt("\nWhat is your local internet domain name :",$def);
  
! $cfg{'inet_domain'} = ($ans =~ /(\S+)/)[0];
  
  #---------------------------------------------------------------------------
  
--- 517,532 ----
  
  $def = $oldcfg{'ftp_int_passive'} || 0;
  
! $cfg{'ftp_int_passive'} = 0;
  
  
  #---------------------------------------------------------------------------
  
! $def = $oldcfg{'inet_domain'} || $ENV{DOMAIN_NAME};
  
! # $ans = Prompt("\nWhat is your local internet domain name :",$def);
  
! $cfg{'inet_domain'} = $def;
  
  #---------------------------------------------------------------------------
  
***************
*** 540,546 ****
  Do you want me to run these tests (y|n) ?
  EDQ
  
! $cfg{'test_hosts'} = get_bool($msg,$oldcfg{'test_hosts'});
  
  #---------------------------------------------------------------------------
  
--- 542,548 ----
  Do you want me to run these tests (y|n) ?
  EDQ
  
! $cfg{'test_hosts'} = 0;
  
  #---------------------------------------------------------------------------
  
