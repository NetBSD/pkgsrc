$NetBSD: patch-aa,v 1.1.1.1 2002/07/11 21:40:41 agc Exp $

--- Makefile.orig	Fri Apr 16 00:05:15 1999
+++ Makefile
@@ -1,14 +1,13 @@
 SHELL=/bin/sh
-CC = gcc
-C_FLAGS = -Wall -g -O2 -m486 -fno-strength-reduce
-GTK_CFLAGS = `gtk-config --cflags`
-GTK_LIBS = `gtk-config --libs` 
+C_FLAGS = $(CFLAGS) -Wall
+GTK_CFLAGS = `$(GTK_CONFIG) --cflags`
+GTK_LIBS = `$(GTK_CONFIG) --libs` 
 LFLAGS = $(GTK_LIBS) -lresolv -lXmu -lXt -lSM -lICE
 PROGNAME = IglooFTP
 PROGNAME-STATIC = IglooFTP-static
 VERSION = 0.6.1
 VERSION_DATE = 1999
-DESTDIR = /usr/local
+DESTDIR = $(PREFIX)
 BIN_PATH = $(DESTDIR)/bin
 MAN_PATH = $(DESTDIR)/man
 SHARE_PATH = $(DESTDIR)/share/$(PROGNAME)
@@ -16,6 +15,8 @@
 RPM_BUILDPATH = /usr/src/redhat
 CODE_LINES = `cat *.c *.h | grep -ch -e "[[:alpha:]|[:punct:]]"` 
 
+all: $(PROGNAME)
+
 $(PROGNAME): main.o GTKmisc.o menu.o toolbar.o connectbar.o statusbar.o\
 	dirlist.o ftplist.o queue.o log.o console.o dialog.o chmod.o\
 	version.o custom.o string.o pixmaps.o color.o cursor.o\
@@ -30,34 +31,34 @@
 
 install : 
 	@if ! test -e $(SHARE_PATH); then \
-	echo "Making $(SHARE_PATH) directory ..."; mkdir -m 0755 $(SHARE_PATH); \
+	echo "Making $(SHARE_PATH) directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH); \
 	else :; fi;	
 	@if ! test -e $(SHARE_PATH)/docs; then \
-	echo "Making $(SHARE_PATH)/docs directory ..."; mkdir -m 0755 $(SHARE_PATH)/docs; \
+	echo "Making $(SHARE_PATH)/docs directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH)/docs; \
 	else :; fi;
 	@if ! test -e $(SHARE_PATH)/html; then \
-	echo "Making $(SHARE_PATH)/html directory ..."; mkdir -m 0755 $(SHARE_PATH)/html; \
+	echo "Making $(SHARE_PATH)/html directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH)/html; \
 	else :; fi;
 	@if ! test -e $(SHARE_PATH)/html/images; then \
-	echo "Making $(SHARE_PATH)/html/images directory ..."; mkdir -m 0755 $(SHARE_PATH)/html/images; \
+	echo "Making $(SHARE_PATH)/html/images directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH)/html/images; \
 	else :; fi;
 	@if ! test -e $(SHARE_PATH)/xpm; then \
-	echo "Making $(SHARE_PATH)/xpm directory ..."; mkdir -m 0755 $(SHARE_PATH)/xpm; \
+	echo "Making $(SHARE_PATH)/xpm directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH)/xpm; \
 	else :; fi;
 	@if ! test -e $(SHARE_PATH)/bookmarks; then \
-	echo "Making $(SHARE_PATH)/bookmarks directory ..."; mkdir -m 0755 $(SHARE_PATH)/bookmarks; \
+	echo "Making $(SHARE_PATH)/bookmarks directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH)/bookmarks; \
 	else :; fi;
 	@if ! test -e $(SHARE_PATH)/app_ass; then \
-	echo "Making $(SHARE_PATH)/app_ass directory ..."; mkdir -m 0755 $(SHARE_PATH)/app_ass; \
+	echo "Making $(SHARE_PATH)/app_ass directory ..."; $(BSD_INSTALL_DATA_DIR) $(SHARE_PATH)/app_ass; \
 	else :; fi;
-	/usr/bin/install -s -m 755 $(PROGNAME) $(BIN_PATH)
-	/usr/bin/install -m 644 ../share/docs/* $(SHARE_PATH)/docs/
-	/usr/bin/install -m 644 ../share/html/*.* $(SHARE_PATH)/html/
-	/usr/bin/install -m 644 ../share/html/images/*.* $(SHARE_PATH)/html/images/
-	/usr/bin/install -m 644 ../share/xpm/* $(SHARE_PATH)/xpm/
-	/usr/bin/install -m 644 ../share/bookmarks/* $(SHARE_PATH)/bookmarks/
-	/usr/bin/install -m 644 ../share/app_ass/* $(SHARE_PATH)/app_ass/
-	/usr/bin/install -m 644 ../share/gtkrc $(SHARE_PATH)/gtkrc	
+	$(BSD_INSTALL_PROGRAM) $(PROGNAME) $(BIN_PATH)
+	$(BSD_INSTALL_DATA) ../share/docs/* $(SHARE_PATH)/docs/
+	$(BSD_INSTALL_DATA) ../share/html/*.* $(SHARE_PATH)/html/
+	$(BSD_INSTALL_DATA) ../share/html/images/*.* $(SHARE_PATH)/html/images/
+	$(BSD_INSTALL_DATA) ../share/xpm/* $(SHARE_PATH)/xpm/
+	$(BSD_INSTALL_DATA) ../share/bookmarks/* $(SHARE_PATH)/bookmarks/
+	$(BSD_INSTALL_DATA) ../share/app_ass/* $(SHARE_PATH)/app_ass/
+	$(BSD_INSTALL_DATA) ../share/gtkrc $(SHARE_PATH)/gtkrc	
 
 
 
@@ -111,7 +112,7 @@
 	@echo "#define COMPILE_TIME \"`date +%T`\"" >> version.h
 	@echo "#define COMPILE_BY \"`whoami`\"" >> version.h
 	@echo "#define COMPILE_HOST \"`hostname`\"" >> version.h
-	@echo "#define GTK_VERSION \"GTK+ `gtk-config --version`\"" >> version.h
+	@echo "#define GTK_VERSION \"GTK+ `$(GTK_CONFIG) --version`\"" >> version.h
 	@echo "#define CC_VERSION \"`$(CC) -v 2>&1 | tail -1`\"">>version.h
 	@echo "#define CODE_LINES \"`cat *.c *.h | grep -ch -e \"[[:alpha:]|[:punct:]]\"`\"">>version.h
 
