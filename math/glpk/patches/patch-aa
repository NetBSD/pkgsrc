$NetBSD: patch-aa,v 1.2 2006/02/04 11:54:51 markd Exp $

--- src/Makefile.in.orig	2006-01-17 22:00:00.000000000 +1300
+++ src/Makefile.in
@@ -65,7 +65,7 @@ VERSION = @VERSION@
 
 INCLUDES = -I../include
 
-lib_LIBRARIES = libglpk.a
+lib_LIBRARIES = libglpk.la
 
 libglpk_a_SOURCES =  glpavl.c glpdmp.c glphbm.c glpiet.c glpinv.c glpios1.c glpios2.c glpios3.c glpipm.c glpipp1.c glpipp2.c glplib1a.c glplib1b.c glplib2.c glplib3.c glplib4.c glplpp1.c glplpp2.c glplpx1.c glplpx2.c glplpx3.c glplpx4.c glplpx5.c glplpx6a.c glplpx6b.c glplpx6c.c glplpx6d.c glplpx7.c glplpx7a.c glplpx8a.c glplpx8b.c glplpx8c.c glplpx8d.c glplpx8e.c glpluf.c glpmat.c glpmip1.c glpmip2.c glpmpl1.c glpmpl2.c glpmpl3.c glpmpl4.c glpqmd.c glprng.c glpspx1.c glpspx2.c glpstr.c glptsp.c
 
@@ -89,9 +89,9 @@ glpmpl1.o glpmpl2.o glpmpl3.o glpmpl4.o 
 glpspx2.o glpstr.o glptsp.o
 AR = ar
 CFLAGS = @CFLAGS@
-COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
+COMPILE = ${LIBTOOL} --mode=compile $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
 CCLD = $(CC)
-LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@
+LINK = ${LIBTOOL} --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@
 DIST_COMMON =  Makefile.am Makefile.in
 
 
@@ -139,15 +139,7 @@ install-libLIBRARIES: $(lib_LIBRARIES)
 	$(mkinstalldirs) $(DESTDIR)$(libdir)
 	@list='$(lib_LIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
-	    echo " $(INSTALL_DATA) $$p $(DESTDIR)$(libdir)/$$p"; \
-	    $(INSTALL_DATA) $$p $(DESTDIR)$(libdir)/$$p; \
-	  else :; fi; \
-	done
-	@$(POST_INSTALL)
-	@list='$(lib_LIBRARIES)'; for p in $$list; do \
-	  if test -f $$p; then \
-	    echo " $(RANLIB) $(DESTDIR)$(libdir)/$$p"; \
-	    $(RANLIB) $(DESTDIR)$(libdir)/$$p; \
+	    ${LIBTOOL} --mode=install ${BSD_INSTALL_LIB} $$p $(DESTDIR)$(libdir)/$$p; \
 	  else :; fi; \
 	done
 
@@ -173,10 +165,9 @@ distclean-compile:
 
 maintainer-clean-compile:
 
-libglpk.a: $(libglpk_a_OBJECTS) $(libglpk_a_DEPENDENCIES)
-	-rm -f libglpk.a
-	$(AR) cru libglpk.a $(libglpk_a_OBJECTS) $(libglpk_a_LIBADD)
-	$(RANLIB) libglpk.a
+libglpk.la: $(libglpk_a_OBJECTS) $(libglpk_a_DEPENDENCIES)
+	${LIBTOOL} --mode=link ${CC} -o $@ \
+	${libglpk_a_OBJECTS:.o=.lo} -rpath ${PREFIX}/lib -version-info 4:9
 
 tags: TAGS
 
