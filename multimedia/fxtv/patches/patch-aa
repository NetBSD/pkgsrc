$NetBSD: patch-aa,v 1.2 2004/09/28 15:26:09 tron Exp $

--- Makefile.orig	2001-02-12 23:08:59.000000000 +0100
+++ Makefile	2004-09-28 17:22:05.000000000 +0200
@@ -4,13 +4,10 @@
 
 HAVE_XFREE86 = YES
 
-ifneq ($(X11PREFIX),)                      # NetBSD
-X11BASE      ?= $(X11PREFIX)
-else
 X11BASE      ?= /usr/X11R6
-endif
+X11BASEINST  ?= $(PREFIX)
 
-X11BASEINST  ?= $(X11BASE)
+PREFIX       ?= /usr/local
 LOCALBASE    ?= /usr/local
 DEBUG        = NO
 OS           = $(shell uname -s)
@@ -24,15 +21,6 @@
 override SHELL             = /bin/sh
 
 #
-# NetBSD stuff
-#
-ifeq ($(OS),NetBSD)
-  override INC            += -I/usr/pkg/include
-  override LIBDIRS        += /usr/pkg/lib
-  override LD_INC         += -lossaudio -lz
-endif
-
-#
 # OpenBSD stuff
 #
 ifeq ($(OS),OpenBSD)
@@ -51,9 +39,9 @@
   override RPATH_FLAG      = -R
 endif
 
-override LD_INC            = $(foreach dir,$(LIBDIRS),-Wl,-L,$(dir))
+override LD_INC            = $(foreach dir,$(LIBDIRS),-Wl,-L$(dir))
 ifneq ($(RPATH_FLAG),)
-  override LD_INC         += $(foreach dir,$(LIBDIRS),-Wl,$(RPATH_FLAG),$(dir))
+  override LD_INC         += $(foreach dir,$(LIBDIRS),-Wl,$(RPATH_FLAG)$(dir))
 endif
 
 #
@@ -72,6 +60,15 @@
 
 override CFLAGS           += $(C_WARN_FLAG) -DX11BASE=\"$(X11BASEINST)\"
 
+#
+# NetBSD stuff
+#
+ifeq ($(OS),NetBSD)
+  override INC            += -I$(LOCALBASE)/include
+  override LIBDIRS        += $(LOCALBASE)/lib
+  override LD_INC         += $(LIBOSSAUDIO) -lz
+endif
+
 ifeq ($(OS), linux)
 override CFLAGS            = $(CFLAGS) -DOLD_TUNER_IFACE
 endif
@@ -81,7 +78,7 @@
 #
 override LDFLAGS           = $(LD_INC) 
 override VIDEOLIB_LIB      = $(VIDEOLIB_DIR)/libvideo.a
-override LIBS              = -ltiff -ljpeg -lXaw3d -lXmu -lXt -lXpm \
+override LIBS              = -lpng -ltiff -ljpeg -lXaw3d -lXmu -lXt -lXpm \
                              -lSM -lICE -lXext -lX11 -lm
 ifeq ($(HAVE_XFREE86),YES)
   override LIBS           += -lXxf86dga -lXxf86vm
