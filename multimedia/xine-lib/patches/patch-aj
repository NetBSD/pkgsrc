$NetBSD: patch-aj,v 1.3 2005/01/06 12:04:08 tron Exp $

--- src/demuxers/demux_aiff.c.orig	2004-06-13 22:28:52.000000000 +0100
+++ src/demuxers/demux_aiff.c	2005-01-06 11:38:44.000000000 +0000
@@ -122,7 +122,8 @@
     chunk_size = BE_32(&preamble[4]);
 
     if (chunk_type == COMM_TAG) {
-      if (this->input->read(this->input, buffer, chunk_size) !=
+      if (chunk_size > sizeof (buffer) ||
+	this->input->read(this->input, buffer, chunk_size) !=
         chunk_size) {
         this->status = DEMUX_FINISHED;
         return 0;
