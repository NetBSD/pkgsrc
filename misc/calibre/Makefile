# $NetBSD: Makefile,v 1.23 2011/10/27 20:40:02 gls Exp $
#

DISTNAME=	calibre-0.8.24
CATEGORIES=	misc
MASTER_SITES=	http://status.calibre-ebook.com/dist/src/ \
		http://calibre-ebook.googlecode.com/files/

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	http://www.calibre-ebook.com/
COMMENT=	E-book library management application
LICENSE=	gnu-gpl-v3

DEPENDS+=	help2man>=1.36.4:../../converters/help2man
DEPENDS+=	${PYPKGPREFIX}-sqlite3-[0-9]*:../../databases/py-sqlite3
DEPENDS+=	xdg-utils>=1.0.2:../../misc/xdg-utils
DEPENDS+=	poppler-utils-[0-9]*:../../print/poppler-utils
DEPENDS+=	${PYPKGPREFIX}-dns>=1.6.0:../../net/py-dns
DEPENDS+=	${PYPKGPREFIX}-lxml>=2.2.1:../../textproc/py-lxml
DEPENDS+=	${PYPKGPREFIX}-dateutil>=1.4.1:../../time/py-dateutil
DEPENDS+=	${PYPKGPREFIX}-ClientForm-[0-9]*:../../www/py-ClientForm
DEPENDS+=	${PYPKGPREFIX}-beautifulsoup>=3.0.5:../../www/py-beautifulsoup
DEPENDS+=	${PYPKGPREFIX}-mechanize>=0.1.11:../../www/py-mechanize
DEPENDS+=	${PYPKGPREFIX}-cssutils>=0.9.7:../../textproc/py-cssutils
# Let's depend on the ones we have in pkgsrc instead of the bundled ones.
DEPENDS+=	${PYPKGPREFIX}-Pdf-[0-9]*:../../print/py-Pdf
DEPENDS+=	${PYPKGPREFIX}-cherrypy-[0-9]*:../../www/py-cherrypy

PKG_DESTDIR_SUPPORT=	user-destdir
SPECIAL_PERMS+=	bin/calibre-mount-helper ${SETUID_ROOT_PERMS}

USE_LANGUAGES=	c c++
USE_TOOLS+=	pkg-config pax
PYTHON_VERSIONS_ACCEPTED=	27
PYDISTUTILSPKG=	yes
PYSETUPOPTARGS=	# empty
PYSETUPINSTALLARGS=	--prefix=${PREFIX} --root=${DESTDIR:Q}${PREFIX}
WRKSRC=		${WRKDIR}/calibre

INSTALLATION_DIRS=	share/applications
INSTALLATION_DIRS=	share/icons
INSTALLATION_DIRS=	share/calibre/recipes

FIX_PYTHON+=	recipes/180.recipe
FIX_PYTHON+=	recipes/24sata.recipe
FIX_PYTHON+=	recipes/7dias.recipe
FIX_PYTHON+=	recipes/7seri.recipe
FIX_PYTHON+=	recipes/Ansa.recipe
FIX_PYTHON+=	recipes/accountancyage.recipe
FIX_PYTHON+=	recipes/adevarul.recipe
FIX_PYTHON+=	recipes/adnkronos.recipe
FIX_PYTHON+=	recipes/ajc.recipe
FIX_PYTHON+=	recipes/apcom.recipe
FIX_PYTHON+=	recipes/arcamax.recipe
FIX_PYTHON+=	recipes/asia_one.recipe
FIX_PYTHON+=	recipes/atlantic.recipe
FIX_PYTHON+=	recipes/auto.recipe
FIX_PYTHON+=	recipes/auto_prove.recipe
FIX_PYTHON+=	recipes/autobild.recipe
FIX_PYTHON+=	recipes/avantaje.recipe
FIX_PYTHON+=	recipes/aventurilapescuit.recipe
FIX_PYTHON+=	recipes/axxon_news.recipe
FIX_PYTHON+=	recipes/babyonline.recipe
FIX_PYTHON+=	recipes/bbcvietnamese.recipe
FIX_PYTHON+=	recipes/beta_en.recipe
FIX_PYTHON+=	recipes/billorielly.recipe
FIX_PYTHON+=	recipes/bitacora.recipe
FIX_PYTHON+=	recipes/boortz.recipe
FIX_PYTHON+=	recipes/borba.recipe
FIX_PYTHON+=	recipes/brand_eins.recipe
FIX_PYTHON+=	recipes/bucataras.recipe
FIX_PYTHON+=	recipes/calgary_herald.recipe
FIX_PYTHON+=	recipes/capital.recipe
FIX_PYTHON+=	recipes/catavencu.recipe
FIX_PYTHON+=	recipes/chicago_breaking_news.recipe
FIX_PYTHON+=	recipes/chipro.recipe
FIX_PYTHON+=	recipes/chr_mon.recipe
FIX_PYTHON+=	recipes/cincinnati_enquirer.recipe
FIX_PYTHON+=	recipes/cinebel_be.recipe
FIX_PYTHON+=	recipes/cio.recipe
FIX_PYTHON+=	recipes/climate_progress.recipe
FIX_PYTHON+=	recipes/cnd.recipe
FIX_PYTHON+=	recipes/coding_horror.recipe
FIX_PYTHON+=	recipes/computer_active.recipe
FIX_PYTHON+=	recipes/corriere_della_sera_en.recipe
FIX_PYTHON+=	recipes/corriere_della_sera_it.recipe
FIX_PYTHON+=	recipes/corriere_dello_sport.recipe
FIX_PYTHON+=	recipes/cosmopolitan.recipe
FIX_PYTHON+=	recipes/cotidianul.recipe
FIX_PYTHON+=	recipes/courrierinternational.recipe
FIX_PYTHON+=	recipes/craigslist.recipe
FIX_PYTHON+=	recipes/credit_slips.recipe
FIX_PYTHON+=	recipes/csid.recipe
FIX_PYTHON+=	recipes/curierulnational.recipe
FIX_PYTHON+=	recipes/daily_telegraph.recipe
FIX_PYTHON+=	recipes/dailyreckoning.recipe
FIX_PYTHON+=	recipes/degentenaar.recipe
FIX_PYTHON+=	recipes/deia.recipe
FIX_PYTHON+=	recipes/demorgen_be.recipe
FIX_PYTHON+=	recipes/der_spiegel.recipe
FIX_PYTHON+=	recipes/der_standard.recipe
FIX_PYTHON+=	recipes/descopera.recipe
FIX_PYTHON+=	recipes/dhnet_be.recipe
FIX_PYTHON+=	recipes/di.recipe
FIX_PYTHON+=	recipes/diagonales.recipe
FIX_PYTHON+=	recipes/diario_cordoba.recipe
FIX_PYTHON+=	recipes/digital_arts.recipe
FIX_PYTHON+=	recipes/discover_magazine.recipe
FIX_PYTHON+=	recipes/divahair.recipe
FIX_PYTHON+=	recipes/dn_se.recipe
FIX_PYTHON+=	recipes/dnevni_avaz.recipe
FIX_PYTHON+=	recipes/dnevnik_cro.recipe
FIX_PYTHON+=	recipes/dnevnik_mk.recipe
FIX_PYTHON+=	recipes/eclicto.recipe
FIX_PYTHON+=	recipes/ecogeek.recipe
FIX_PYTHON+=	recipes/economist.recipe
FIX_PYTHON+=	recipes/economist_free.recipe
FIX_PYTHON+=	recipes/ecuisine.recipe
FIX_PYTHON+=	recipes/editor_and_publisher.recipe
FIX_PYTHON+=	recipes/edmonton_journal.recipe
FIX_PYTHON+=	recipes/egirl.recipe
FIX_PYTHON+=	recipes/eksiazki.recipe
FIX_PYTHON+=	recipes/el_correo.recipe
FIX_PYTHON+=	recipes/el_observador.recipe
FIX_PYTHON+=	recipes/el_pais.recipe
FIX_PYTHON+=	recipes/el_pais_uy.recipe
FIX_PYTHON+=	recipes/el_periodico.recipe
FIX_PYTHON+=	recipes/el_publico.recipe
FIX_PYTHON+=	recipes/elargentino.recipe
FIX_PYTHON+=	recipes/ele.recipe
FIX_PYTHON+=	recipes/elperiodico_catalan.recipe
FIX_PYTHON+=	recipes/elperiodico_spanish.recipe
FIX_PYTHON+=	recipes/eltiempo_hn.recipe
FIX_PYTHON+=	recipes/endgadget.recipe
FIX_PYTHON+=	recipes/epicurious.recipe
FIX_PYTHON+=	recipes/epl_talk.recipe
FIX_PYTHON+=	recipes/esenja.recipe
FIX_PYTHON+=	recipes/espn.recipe
FIX_PYTHON+=	recipes/evz.ro.recipe
FIX_PYTHON+=	recipes/expansion_spanish.recipe
FIX_PYTHON+=	recipes/fan_graphs.recipe
FIX_PYTHON+=	recipes/fastcompany.recipe
FIX_PYTHON+=	recipes/felicia.recipe
FIX_PYTHON+=	recipes/fhmro.recipe
FIX_PYTHON+=	recipes/financiarul.recipe
FIX_PYTHON+=	recipes/fr_online.recipe
FIX_PYTHON+=	recipes/frazpc.recipe
FIX_PYTHON+=	recipes/freakonomics.recipe
FIX_PYTHON+=	recipes/freeway.recipe
FIX_PYTHON+=	recipes/fronda.recipe
FIX_PYTHON+=	recipes/fudzilla.recipe
FIX_PYTHON+=	recipes/gandul.recipe
FIX_PYTHON+=	recipes/gazeta-prawna-calibre-v1.recipe
FIX_PYTHON+=	recipes/gazeta_pomorska.recipe
FIX_PYTHON+=	recipes/globe_and_mail.recipe
FIX_PYTHON+=	recipes/go4it.recipe
FIX_PYTHON+=	recipes/go_comics.recipe
FIX_PYTHON+=	recipes/gosc_niedzielny.recipe
FIX_PYTHON+=	recipes/granma.recipe
FIX_PYTHON+=	recipes/gsp.recipe
FIX_PYTHON+=	recipes/guardian.recipe
FIX_PYTHON+=	recipes/gva_be.recipe
FIX_PYTHON+=	recipes/h2.recipe
FIX_PYTHON+=	recipes/h3.recipe
FIX_PYTHON+=	recipes/hackernews.recipe
FIX_PYTHON+=	recipes/heraldo.recipe
FIX_PYTHON+=	recipes/histmag.recipe
FIX_PYTHON+=	recipes/historiaro.recipe
FIX_PYTHON+=	recipes/hitro.recipe
FIX_PYTHON+=	recipes/hln.recipe
FIX_PYTHON+=	recipes/hln_be.recipe
FIX_PYTHON+=	recipes/hola.recipe
FIX_PYTHON+=	recipes/hotcity.recipe
FIX_PYTHON+=	recipes/hotnews.recipe
FIX_PYTHON+=	recipes/houston_chronicle.recipe
FIX_PYTHON+=	recipes/hoy.recipe
FIX_PYTHON+=	recipes/hrt.recipe
FIX_PYTHON+=	recipes/ieco.recipe
FIX_PYTHON+=	recipes/il_giornale.recipe
FIX_PYTHON+=	recipes/il_messaggero.recipe
FIX_PYTHON+=	recipes/imperatortravel.recipe
FIX_PYTHON+=	recipes/infomotori.recipe
FIX_PYTHON+=	recipes/infoworld.recipe
FIX_PYTHON+=	recipes/inquirer_net.recipe
FIX_PYTHON+=	recipes/intelligencer.recipe
FIX_PYTHON+=	recipes/interia_fakty.recipe
FIX_PYTHON+=	recipes/interia_sport.recipe
FIX_PYTHON+=	recipes/intrefete.recipe
FIX_PYTHON+=	recipes/jakarta_post.recipe
FIX_PYTHON+=	recipes/javalobby.recipe
FIX_PYTHON+=	recipes/jb_online.recipe
FIX_PYTHON+=	recipes/joelonsoftware.recipe
FIX_PYTHON+=	recipes/journalgazette.recipe
FIX_PYTHON+=	recipes/jurnalulnational.recipe
FIX_PYTHON+=	recipes/jutarnji.recipe
FIX_PYTHON+=	recipes/juventudrebelde_english.recipe
FIX_PYTHON+=	recipes/kamikaze.recipe
FIX_PYTHON+=	recipes/kellog_faculty.recipe
FIX_PYTHON+=	recipes/kellog_insight.recipe
FIX_PYTHON+=	recipes/kompas.recipe
FIX_PYTHON+=	recipes/krstarica.recipe
FIX_PYTHON+=	recipes/krstarica_en.recipe
FIX_PYTHON+=	recipes/kudika.recipe
FIX_PYTHON+=	recipes/kukuburi.recipe
FIX_PYTHON+=	recipes/l_espresso.recipe
FIX_PYTHON+=	recipes/la_cuarta.recipe
FIX_PYTHON+=	recipes/la_diaria.recipe
FIX_PYTHON+=	recipes/la_gazzeta_dello_sport.recipe
FIX_PYTHON+=	recipes/la_stampa.recipe
FIX_PYTHON+=	recipes/lalibre_be.recipe
FIX_PYTHON+=	recipes/lameuse_be.recipe
FIX_PYTHON+=	recipes/lamujerdemivida.recipe
FIX_PYTHON+=	recipes/lanacion_chile.recipe
FIX_PYTHON+=	recipes/laprensa.recipe
FIX_PYTHON+=	recipes/laprensa_hn.recipe
FIX_PYTHON+=	recipes/laprensa_ni.recipe
FIX_PYTHON+=	recipes/latribuna.recipe
FIX_PYTHON+=	recipes/lavanguardia.recipe
FIX_PYTHON+=	recipes/lavenir_be.recipe
FIX_PYTHON+=	recipes/le_temps.recipe
FIX_PYTHON+=	recipes/legeartis.recipe
FIX_PYTHON+=	recipes/leggo_it.recipe
FIX_PYTHON+=	recipes/legitymizm.recipe
FIX_PYTHON+=	recipes/lenta_ru.recipe
FIX_PYTHON+=	recipes/lescienze.recipe
FIX_PYTHON+=	recipes/lesoir_be.recipe
FIX_PYTHON+=	recipes/liberation.recipe
FIX_PYTHON+=	recipes/libero.recipe
FIX_PYTHON+=	recipes/linux_magazine.recipe
FIX_PYTHON+=	recipes/livemint.recipe
FIX_PYTHON+=	recipes/lwn.recipe
FIX_PYTHON+=	recipes/lwn_weekly.recipe
FIX_PYTHON+=	recipes/mac_video.recipe
FIX_PYTHON+=	recipes/mac_world.recipe
FIX_PYTHON+=	recipes/mac_world_uk.recipe
FIX_PYTHON+=	recipes/macleans.recipe
FIX_PYTHON+=	recipes/malaysian_mirror.recipe
FIX_PYTHON+=	recipes/mayra.recipe
FIX_PYTHON+=	recipes/mediafax.recipe
FIX_PYTHON+=	recipes/mediaindonesia.recipe
FIX_PYTHON+=	recipes/medscape.recipe
FIX_PYTHON+=	recipes/michalkiewicz.recipe
FIX_PYTHON+=	recipes/milenio.recipe
FIX_PYTHON+=	recipes/miradasalsur.recipe
FIX_PYTHON+=	recipes/moldovaazi.recipe
FIX_PYTHON+=	recipes/mondedurable.recipe
FIX_PYTHON+=	recipes/monden.recipe
FIX_PYTHON+=	recipes/moneynews.recipe
FIX_PYTHON+=	recipes/moneyro.recipe
FIX_PYTHON+=	recipes/monitor.recipe
FIX_PYTHON+=	recipes/montevideo_com.recipe
FIX_PYTHON+=	recipes/montreal_gazette.recipe
FIX_PYTHON+=	recipes/msdnmag_en.recipe
FIX_PYTHON+=	recipes/nacional_cro.recipe
FIX_PYTHON+=	recipes/nakedcapitalism.recipe
FIX_PYTHON+=	recipes/natgeo.recipe
FIX_PYTHON+=	recipes/nationalgeoro.recipe
FIX_PYTHON+=	recipes/new_york_review_of_books.recipe
FIX_PYTHON+=	recipes/new_york_review_of_books_no_sub.recipe
FIX_PYTHON+=	recipes/newsmoldova.recipe
FIX_PYTHON+=	recipes/newsweek_argentina.recipe
FIX_PYTHON+=	recipes/newsweek_polska.recipe
FIX_PYTHON+=	recipes/njp.recipe
FIX_PYTHON+=	recipes/noaa.recipe
FIX_PYTHON+=	recipes/nortecastilla.recipe
FIX_PYTHON+=	recipes/now_toronto.recipe
FIX_PYTHON+=	recipes/nrc-nl-epub.recipe
FIX_PYTHON+=	recipes/nymag.recipe
FIX_PYTHON+=	recipes/nytimes.recipe
FIX_PYTHON+=	recipes/nytimes_sports.recipe
FIX_PYTHON+=	recipes/nytimes_sub.recipe
FIX_PYTHON+=	recipes/nytimes_tech.recipe
FIX_PYTHON+=	recipes/o_globo.recipe
FIX_PYTHON+=	recipes/observa_digital.recipe
FIX_PYTHON+=	recipes/observer_gb.recipe
FIX_PYTHON+=	recipes/oc_register.recipe
FIX_PYTHON+=	recipes/onemagazine.recipe
FIX_PYTHON+=	recipes/onionavclub.recipe
FIX_PYTHON+=	recipes/osnews_pl.recipe
FIX_PYTHON+=	recipes/ottawa_citizen.recipe
FIX_PYTHON+=	recipes/outlook_india.recipe
FIX_PYTHON+=	recipes/pagina_12_print_ed.recipe
FIX_PYTHON+=	recipes/panorama.recipe
FIX_PYTHON+=	recipes/pc_advisor.recipe
FIX_PYTHON+=	recipes/pc_lab.recipe
FIX_PYTHON+=	recipes/pc_mag.recipe
FIX_PYTHON+=	recipes/pc_world.recipe
FIX_PYTHON+=	recipes/pcworld_hu.recipe
FIX_PYTHON+=	recipes/pcworldro.recipe
FIX_PYTHON+=	recipes/people_us_mashup.recipe
FIX_PYTHON+=	recipes/phd_comics.recipe
FIX_PYTHON+=	recipes/plus_info.recipe
FIX_PYTHON+=	recipes/pobjeda.recipe
FIX_PYTHON+=	recipes/politico.recipe
FIX_PYTHON+=	recipes/polityka.recipe
FIX_PYTHON+=	recipes/portfolio.recipe
FIX_PYTHON+=	recipes/pressonline.recipe
FIX_PYTHON+=	recipes/promotor.recipe
FIX_PYTHON+=	recipes/prosport.recipe
FIX_PYTHON+=	recipes/prostamerika.recipe
FIX_PYTHON+=	recipes/protvmagazin.recipe
FIX_PYTHON+=	recipes/psychologies.recipe
FIX_PYTHON+=	recipes/publico.recipe
FIX_PYTHON+=	recipes/publika.recipe
FIX_PYTHON+=	recipes/punto_informatico.recipe
FIX_PYTHON+=	recipes/quotidiano.recipe
FIX_PYTHON+=	recipes/readers_digest.recipe
FIX_PYTHON+=	recipes/realitatea.recipe
FIX_PYTHON+=	recipes/red_aragon.recipe
FIX_PYTHON+=	recipes/regina_leader_post.recipe
FIX_PYTHON+=	recipes/replicavedetelor.recipe
FIX_PYTHON+=	recipes/republika.recipe
FIX_PYTHON+=	recipes/revista_bla.recipe
FIX_PYTHON+=	recipes/rga.recipe
FIX_PYTHON+=	recipes/rmf24_ESKN.recipe
FIX_PYTHON+=	recipes/rmf24_fakty.recipe
FIX_PYTHON+=	recipes/rmf24_opinie.recipe
FIX_PYTHON+=	recipes/romanialibera.recipe
FIX_PYTHON+=	recipes/rstones.recipe
FIX_PYTHON+=	recipes/rts.recipe
FIX_PYTHON+=	recipes/salon.recipe
FIX_PYTHON+=	recipes/san_fran_chronicle.recipe
FIX_PYTHON+=	recipes/sanjosemercurynews.recipe
FIX_PYTHON+=	recipes/saskatoon_star_phoenix.recipe
FIX_PYTHON+=	recipes/sb_nation.recipe
FIX_PYTHON+=	recipes/science_aas.recipe
FIX_PYTHON+=	recipes/science_based_medicine.recipe
FIX_PYTHON+=	recipes/science_news.recipe
FIX_PYTHON+=	recipes/science_news_recent_issues.recipe
FIX_PYTHON+=	recipes/sciencedaily.recipe
FIX_PYTHON+=	recipes/scientific_american.recipe
FIX_PYTHON+=	recipes/scott_hanselman.recipe
FIX_PYTHON+=	recipes/seanhannity.recipe
FIX_PYTHON+=	recipes/seattle_times.recipe
FIX_PYTHON+=	recipes/serverside.recipe
FIX_PYTHON+=	recipes/sfin.recipe
FIX_PYTHON+=	recipes/slashdot.recipe
FIX_PYTHON+=	recipes/slate.recipe
FIX_PYTHON+=	recipes/smashing.recipe
FIX_PYTHON+=	recipes/socialdiva.recipe
FIX_PYTHON+=	recipes/spiegelde.recipe
FIX_PYTHON+=	recipes/st_petersburg_times.recipe
FIX_PYTHON+=	recipes/stackoverflow.recipe
FIX_PYTHON+=	recipes/standardmoney.recipe
FIX_PYTHON+=	recipes/stiintasitehnica.recipe
FIX_PYTHON+=	recipes/superbebe.recipe
FIX_PYTHON+=	recipes/svd_se.recipe
FIX_PYTHON+=	recipes/swiatkindle.recipe
FIX_PYTHON+=	recipes/tabu.recipe
FIX_PYTHON+=	recipes/tanjug.recipe
FIX_PYTHON+=	recipes/taz.recipe
FIX_PYTHON+=	recipes/tech_world.recipe
FIX_PYTHON+=	recipes/teleread.recipe
FIX_PYTHON+=	recipes/the_age.recipe
FIX_PYTHON+=	recipes/the_budget_fashionista.recipe
FIX_PYTHON+=	recipes/the_escapist.recipe
FIX_PYTHON+=	recipes/the_h.recipe
FIX_PYTHON+=	recipes/the_oz.recipe
FIX_PYTHON+=	recipes/the_scotsman.recipe
FIX_PYTHON+=	recipes/thedgesingapore.recipe
FIX_PYTHON+=	recipes/themarketticker.recipe
FIX_PYTHON+=	recipes/theoldfoodie.recipe
FIX_PYTHON+=	recipes/thestar.recipe
FIX_PYTHON+=	recipes/tijd.recipe
FIX_PYTHON+=	recipes/time_magazine.recipe
FIX_PYTHON+=	recipes/timesnewroman.recipe
FIX_PYTHON+=	recipes/tnxm.recipe
FIX_PYTHON+=	recipes/tomshardware.recipe
FIX_PYTHON+=	recipes/toronto_sun.recipe
FIX_PYTHON+=	recipes/trombon.recipe
FIX_PYTHON+=	recipes/tuttosport.recipe
FIX_PYTHON+=	recipes/tvmania.recipe
FIX_PYTHON+=	recipes/tweakers.recipe
FIX_PYTHON+=	recipes/tyzden.recipe
FIX_PYTHON+=	recipes/uncrate.recipe
FIX_PYTHON+=	recipes/unica.recipe
FIX_PYTHON+=	recipes/upi.recipe
FIX_PYTHON+=	recipes/usatoday.recipe
FIX_PYTHON+=	recipes/usnews.recipe
FIX_PYTHON+=	recipes/utne.recipe
FIX_PYTHON+=	recipes/utrinski.recipe
FIX_PYTHON+=	recipes/vancouver_provice.recipe
FIX_PYTHON+=	recipes/vancouver_sun.recipe
FIX_PYTHON+=	recipes/vecernji_list.recipe
FIX_PYTHON+=	recipes/vedomosti.recipe
FIX_PYTHON+=	recipes/veintitres.recipe
FIX_PYTHON+=	recipes/vic_times.recipe
FIX_PYTHON+=	recipes/viva.recipe
FIX_PYTHON+=	recipes/vnexpress.recipe
FIX_PYTHON+=	recipes/wallstreetro.recipe
FIX_PYTHON+=	recipes/wash_times.recipe
FIX_PYTHON+=	recipes/weblogs_sl.recipe
FIX_PYTHON+=	recipes/wenxuecity-znjy.recipe
FIX_PYTHON+=	recipes/wikinews_en.recipe
FIX_PYTHON+=	recipes/windows_star.recipe
FIX_PYTHON+=	recipes/winter_olympics.recipe
FIX_PYTHON+=	recipes/wired_daily.recipe
FIX_PYTHON+=	recipes/wprost.recipe
FIX_PYTHON+=	recipes/wsj.recipe
FIX_PYTHON+=	recipes/wsj_free.recipe
FIX_PYTHON+=	recipes/wvhooligan.recipe
FIX_PYTHON+=	recipes/zaobao.recipe
FIX_PYTHON+=	recipes/zeitde_sub.recipe
FIX_PYTHON+=	recipes/ziarulfinanciar.recipe
FIX_PYTHON+=	recipes/ziuaveche.recipe
FIX_PYTHON+=	resources/catalog/section_list_templates.py
FIX_PYTHON+=	resources/default_tweaks.py
FIX_PYTHON+=	setup.py
FIX_PYTHON+=	setup/__init__.py
FIX_PYTHON+=	setup/build_environment.py
FIX_PYTHON+=	setup/check.py
FIX_PYTHON+=	setup/commands.py
FIX_PYTHON+=	setup/extensions.py
FIX_PYTHON+=	setup/gui.py
FIX_PYTHON+=	setup/install.py
FIX_PYTHON+=	setup/installer/__init__.py
FIX_PYTHON+=	setup/installer/linux/__init__.py
FIX_PYTHON+=	setup/installer/linux/freeze.py
FIX_PYTHON+=	setup/installer/linux/freeze2.py
FIX_PYTHON+=	setup/installer/osx/__init__.py
FIX_PYTHON+=	setup/installer/osx/app/__init__.py
FIX_PYTHON+=	setup/installer/osx/app/main.py
FIX_PYTHON+=	setup/installer/osx/freeze.py
FIX_PYTHON+=	setup/installer/windows/__init__.py
FIX_PYTHON+=	setup/installer/windows/freeze.py
FIX_PYTHON+=	setup/installer/windows/site.py
FIX_PYTHON+=	setup/installer/windows/wix.py
FIX_PYTHON+=	setup/publish.py
FIX_PYTHON+=	setup/pypi.py
FIX_PYTHON+=	setup/resources.py
FIX_PYTHON+=	setup/server.py
FIX_PYTHON+=	setup/translations.py
FIX_PYTHON+=	setup/upload.py
FIX_PYTHON+=	src/calibre/customize/zipplugin.py
FIX_PYTHON+=	src/calibre/db/__init__.py
FIX_PYTHON+=	src/calibre/db/backend.py
FIX_PYTHON+=	src/calibre/db/cache.py
FIX_PYTHON+=	src/calibre/db/errors.py
FIX_PYTHON+=	src/calibre/db/fields.py
FIX_PYTHON+=	src/calibre/db/locking.py
FIX_PYTHON+=	src/calibre/db/schema_upgrades.py
FIX_PYTHON+=	src/calibre/db/tables.py
FIX_PYTHON+=	src/calibre/db/tests/__init__.py
FIX_PYTHON+=	src/calibre/db/tests/base.py
FIX_PYTHON+=	src/calibre/db/tests/reading.py
FIX_PYTHON+=	src/calibre/db/view.py
FIX_PYTHON+=	src/calibre/debug.py
FIX_PYTHON+=	src/calibre/devices/android/__init__.py
FIX_PYTHON+=	src/calibre/devices/eslick/__init__.py
FIX_PYTHON+=	src/calibre/devices/eslick/driver.py
FIX_PYTHON+=	src/calibre/devices/folder_device/__init__.py
FIX_PYTHON+=	src/calibre/devices/iriver/__init__.py
FIX_PYTHON+=	src/calibre/devices/iriver/driver.py
FIX_PYTHON+=	src/calibre/devices/kobo/__init__.py
FIX_PYTHON+=	src/calibre/devices/kobo/driver.py
FIX_PYTHON+=	src/calibre/devices/misc.py
FIX_PYTHON+=	src/calibre/devices/prs505/sony_cache.py
FIX_PYTHON+=	src/calibre/devices/prst1/__init__.py
FIX_PYTHON+=	src/calibre/devices/prst1/driver.py
FIX_PYTHON+=	src/calibre/devices/teclast/__init__.py
FIX_PYTHON+=	src/calibre/devices/udisks.py
FIX_PYTHON+=	src/calibre/ebooks/chm/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/chm/metadata.py
FIX_PYTHON+=	src/calibre/ebooks/comic/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/compression/palmdoc.py
FIX_PYTHON+=	src/calibre/ebooks/conversion/config.py
FIX_PYTHON+=	src/calibre/ebooks/conversion/preprocess.py
FIX_PYTHON+=	src/calibre/ebooks/conversion/utils.py
FIX_PYTHON+=	src/calibre/ebooks/djvu/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/djvu/djvu.py
FIX_PYTHON+=	src/calibre/ebooks/djvu/djvubzzdec.py
FIX_PYTHON+=	src/calibre/ebooks/epub/fix/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/epub/fix/container.py
FIX_PYTHON+=	src/calibre/ebooks/epub/fix/epubcheck.py
FIX_PYTHON+=	src/calibre/ebooks/epub/fix/main.py
FIX_PYTHON+=	src/calibre/ebooks/epub/fix/unmanifested.py
FIX_PYTHON+=	src/calibre/ebooks/epub/output.py
FIX_PYTHON+=	src/calibre/ebooks/epub/periodical.py
FIX_PYTHON+=	src/calibre/ebooks/html/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/html/input.py
FIX_PYTHON+=	src/calibre/ebooks/html/to_zip.py
FIX_PYTHON+=	src/calibre/ebooks/iterator/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/lit/input.py
FIX_PYTHON+=	src/calibre/ebooks/lit/output.py
FIX_PYTHON+=	src/calibre/ebooks/lrf/html/table_as_image.py
FIX_PYTHON+=	src/calibre/ebooks/lrf/input.py
FIX_PYTHON+=	src/calibre/ebooks/lrf/output.py
FIX_PYTHON+=	src/calibre/ebooks/lrf/pylrs/pylrf.py
FIX_PYTHON+=	src/calibre/ebooks/markdown/extensions/def_list.py
FIX_PYTHON+=	src/calibre/ebooks/markdown/extensions/extra.py
FIX_PYTHON+=	src/calibre/ebooks/markdown/extensions/fenced_code.py
FIX_PYTHON+=	src/calibre/ebooks/markdown/extensions/tables.py
FIX_PYTHON+=	src/calibre/ebooks/markdown/extensions/wikilinks.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/archive.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/book/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/book/base.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/epub.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/fb2.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/html.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/kdl.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/lrx.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/opf2.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/rar.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/amazon.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/base.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/cli.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/covers.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/douban.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/google.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/identify.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/isbndb.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/openlibrary.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/overdrive.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/sources/test.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/toc.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/worker.py
FIX_PYTHON+=	src/calibre/ebooks/metadata/xisbn.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/debug.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/huffcdic.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/langcodes.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/output.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/utils.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/writer2/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/writer2/indexer.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/writer2/main.py
FIX_PYTHON+=	src/calibre/ebooks/mobi/writer2/serializer.py
FIX_PYTHON+=	src/calibre/ebooks/odt/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/cover.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/filenames.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/guide.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/jacket.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/linearize_tables.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/metadata.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/page_margin.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/rescale.py
FIX_PYTHON+=	src/calibre/ebooks/oeb/transforms/structure.py
FIX_PYTHON+=	src/calibre/ebooks/pdf/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/pdf/reflow.py
FIX_PYTHON+=	src/calibre/ebooks/readability/readability.py
FIX_PYTHON+=	src/calibre/ebooks/rtf/preprocess.py
FIX_PYTHON+=	src/calibre/ebooks/rtf2xml/ParseRtf.py
FIX_PYTHON+=	src/calibre/ebooks/rtf2xml/check_encoding.py
FIX_PYTHON+=	src/calibre/ebooks/snb/__init__.py
FIX_PYTHON+=	src/calibre/ebooks/textile/functions.py
FIX_PYTHON+=	src/calibre/ebooks/txt/__init__.py
FIX_PYTHON+=	src/calibre/gui2/actions/__init__.py
FIX_PYTHON+=	src/calibre/gui2/actions/add.py
FIX_PYTHON+=	src/calibre/gui2/actions/add_to_library.py
FIX_PYTHON+=	src/calibre/gui2/actions/annotate.py
FIX_PYTHON+=	src/calibre/gui2/actions/catalog.py
FIX_PYTHON+=	src/calibre/gui2/actions/choose_library.py
FIX_PYTHON+=	src/calibre/gui2/actions/convert.py
FIX_PYTHON+=	src/calibre/gui2/actions/copy_to_library.py
FIX_PYTHON+=	src/calibre/gui2/actions/delete.py
FIX_PYTHON+=	src/calibre/gui2/actions/device.py
FIX_PYTHON+=	src/calibre/gui2/actions/edit_collections.py
FIX_PYTHON+=	src/calibre/gui2/actions/edit_metadata.py
FIX_PYTHON+=	src/calibre/gui2/actions/fetch_news.py
FIX_PYTHON+=	src/calibre/gui2/actions/help.py
FIX_PYTHON+=	src/calibre/gui2/actions/next_match.py
FIX_PYTHON+=	src/calibre/gui2/actions/open.py
FIX_PYTHON+=	src/calibre/gui2/actions/plugin_updates.py
FIX_PYTHON+=	src/calibre/gui2/actions/preferences.py
FIX_PYTHON+=	src/calibre/gui2/actions/random.py
FIX_PYTHON+=	src/calibre/gui2/actions/restart.py
FIX_PYTHON+=	src/calibre/gui2/actions/save_to_disk.py
FIX_PYTHON+=	src/calibre/gui2/actions/show_book_details.py
FIX_PYTHON+=	src/calibre/gui2/actions/show_quickview.py
FIX_PYTHON+=	src/calibre/gui2/actions/similar_books.py
FIX_PYTHON+=	src/calibre/gui2/actions/tweak_epub.py
FIX_PYTHON+=	src/calibre/gui2/actions/view.py
FIX_PYTHON+=	src/calibre/gui2/add_wizard/__init__.py
FIX_PYTHON+=	src/calibre/gui2/bars.py
FIX_PYTHON+=	src/calibre/gui2/book_details.py
FIX_PYTHON+=	src/calibre/gui2/catalog/catalog_bibtex.py
FIX_PYTHON+=	src/calibre/gui2/catalog/catalog_csv_xml.py
FIX_PYTHON+=	src/calibre/gui2/catalog/catalog_epub_mobi.py
FIX_PYTHON+=	src/calibre/gui2/comments_editor.py
FIX_PYTHON+=	src/calibre/gui2/complete.py
FIX_PYTHON+=	src/calibre/gui2/convert/__init__.py
FIX_PYTHON+=	src/calibre/gui2/convert/comic_input.py
FIX_PYTHON+=	src/calibre/gui2/convert/debug.py
FIX_PYTHON+=	src/calibre/gui2/convert/epub_output.py
FIX_PYTHON+=	src/calibre/gui2/convert/font_key.py
FIX_PYTHON+=	src/calibre/gui2/convert/look_and_feel.py
FIX_PYTHON+=	src/calibre/gui2/convert/lrf_output.py
FIX_PYTHON+=	src/calibre/gui2/convert/metadata.py
FIX_PYTHON+=	src/calibre/gui2/convert/mobi_output.py
FIX_PYTHON+=	src/calibre/gui2/convert/page_setup.py
FIX_PYTHON+=	src/calibre/gui2/convert/single.py
FIX_PYTHON+=	src/calibre/gui2/convert/structure_detection.py
FIX_PYTHON+=	src/calibre/gui2/convert/toc.py
FIX_PYTHON+=	src/calibre/gui2/convert/xpath_wizard.py
FIX_PYTHON+=	src/calibre/gui2/cover_flow.py
FIX_PYTHON+=	src/calibre/gui2/custom_column_widgets.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/add_empty_book.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/add_from_isbn.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/book_info.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/catalog.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/check_library.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/choose_library.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/choose_plugin_toolbars.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/comments_dialog.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/confirm_delete.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/confirm_delete_location.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/delete_matching_from_device.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/drm_error.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/edit_authors_dialog.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/message_box.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/plugin_updater.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/progress.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/quickview.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/restore_library.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/select_formats.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/template_dialog.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/template_line_editor.py
FIX_PYTHON+=	src/calibre/gui2/dialogs/tweak_epub.py
FIX_PYTHON+=	src/calibre/gui2/dnd.py
FIX_PYTHON+=	src/calibre/gui2/email.py
FIX_PYTHON+=	src/calibre/gui2/init.py
FIX_PYTHON+=	src/calibre/gui2/jobs.py
FIX_PYTHON+=	src/calibre/gui2/keyboard.py
FIX_PYTHON+=	src/calibre/gui2/languages.py
FIX_PYTHON+=	src/calibre/gui2/layout.py
FIX_PYTHON+=	src/calibre/gui2/library/__init__.py
FIX_PYTHON+=	src/calibre/gui2/library/delegates.py
FIX_PYTHON+=	src/calibre/gui2/library/models.py
FIX_PYTHON+=	src/calibre/gui2/library/views.py
FIX_PYTHON+=	src/calibre/gui2/metadata/__init__.py
FIX_PYTHON+=	src/calibre/gui2/metadata/basic_widgets.py
FIX_PYTHON+=	src/calibre/gui2/metadata/bulk_download.py
FIX_PYTHON+=	src/calibre/gui2/metadata/config.py
FIX_PYTHON+=	src/calibre/gui2/metadata/single.py
FIX_PYTHON+=	src/calibre/gui2/metadata/single_download.py
FIX_PYTHON+=	src/calibre/gui2/notify.py
FIX_PYTHON+=	src/calibre/gui2/preferences/__init__.py
FIX_PYTHON+=	src/calibre/gui2/preferences/adding.py
FIX_PYTHON+=	src/calibre/gui2/preferences/behavior.py
FIX_PYTHON+=	src/calibre/gui2/preferences/coloring.py
FIX_PYTHON+=	src/calibre/gui2/preferences/columns.py
FIX_PYTHON+=	src/calibre/gui2/preferences/conversion.py
FIX_PYTHON+=	src/calibre/gui2/preferences/device_debug.py
FIX_PYTHON+=	src/calibre/gui2/preferences/device_user_defined.py
FIX_PYTHON+=	src/calibre/gui2/preferences/emailp.py
FIX_PYTHON+=	src/calibre/gui2/preferences/history.py
FIX_PYTHON+=	src/calibre/gui2/preferences/keyboard.py
FIX_PYTHON+=	src/calibre/gui2/preferences/look_feel.py
FIX_PYTHON+=	src/calibre/gui2/preferences/main.py
FIX_PYTHON+=	src/calibre/gui2/preferences/metadata_sources.py
FIX_PYTHON+=	src/calibre/gui2/preferences/misc.py
FIX_PYTHON+=	src/calibre/gui2/preferences/plugboard.py
FIX_PYTHON+=	src/calibre/gui2/preferences/plugins.py
FIX_PYTHON+=	src/calibre/gui2/preferences/save_template.py
FIX_PYTHON+=	src/calibre/gui2/preferences/saving.py
FIX_PYTHON+=	src/calibre/gui2/preferences/search.py
FIX_PYTHON+=	src/calibre/gui2/preferences/sending.py
FIX_PYTHON+=	src/calibre/gui2/preferences/server.py
FIX_PYTHON+=	src/calibre/gui2/preferences/template_functions.py
FIX_PYTHON+=	src/calibre/gui2/preferences/toolbar.py
FIX_PYTHON+=	src/calibre/gui2/preferences/tweaks.py
FIX_PYTHON+=	src/calibre/gui2/progress_indicator/__init__.py
FIX_PYTHON+=	src/calibre/gui2/search_box.py
FIX_PYTHON+=	src/calibre/gui2/shortcuts.py
FIX_PYTHON+=	src/calibre/gui2/tag_browser/__init__.py
FIX_PYTHON+=	src/calibre/gui2/tag_browser/model.py
FIX_PYTHON+=	src/calibre/gui2/tag_browser/ui.py
FIX_PYTHON+=	src/calibre/gui2/tag_browser/view.py
FIX_PYTHON+=	src/calibre/gui2/threaded_jobs.py
FIX_PYTHON+=	src/calibre/gui2/throbber.py
FIX_PYTHON+=	src/calibre/gui2/tools.py
FIX_PYTHON+=	src/calibre/gui2/ui.py
FIX_PYTHON+=	src/calibre/gui2/viewer/dictionary.py
FIX_PYTHON+=	src/calibre/gui2/viewer/documentview.py
FIX_PYTHON+=	src/calibre/gui2/viewer/flip.py
FIX_PYTHON+=	src/calibre/gui2/viewer/gestures.py
FIX_PYTHON+=	src/calibre/gui2/viewer/keys.py
FIX_PYTHON+=	src/calibre/gui2/viewer/printing.py
FIX_PYTHON+=	src/calibre/gui2/widgets.py
FIX_PYTHON+=	src/calibre/gui2/wizard/__init__.py
FIX_PYTHON+=	src/calibre/gui2/wizard/send_email.py
FIX_PYTHON+=	src/calibre/library/add_to_library.py
FIX_PYTHON+=	src/calibre/library/caches.py
FIX_PYTHON+=	src/calibre/library/check_library.py
FIX_PYTHON+=	src/calibre/library/cli.py
FIX_PYTHON+=	src/calibre/library/coloring.py
FIX_PYTHON+=	src/calibre/library/comments.py
FIX_PYTHON+=	src/calibre/library/custom_columns.py
FIX_PYTHON+=	src/calibre/library/move.py
FIX_PYTHON+=	src/calibre/library/prefs.py
FIX_PYTHON+=	src/calibre/library/restore.py
FIX_PYTHON+=	src/calibre/library/save_to_disk.py
FIX_PYTHON+=	src/calibre/library/schema_upgrades.py
FIX_PYTHON+=	src/calibre/library/server/__init__.py
FIX_PYTHON+=	src/calibre/library/server/ajax.py
FIX_PYTHON+=	src/calibre/library/server/base.py
FIX_PYTHON+=	src/calibre/library/server/browse.py
FIX_PYTHON+=	src/calibre/library/server/cache.py
FIX_PYTHON+=	src/calibre/library/server/content.py
FIX_PYTHON+=	src/calibre/library/server/main.py
FIX_PYTHON+=	src/calibre/library/server/mobile.py
FIX_PYTHON+=	src/calibre/library/server/opds.py
FIX_PYTHON+=	src/calibre/library/server/utils.py
FIX_PYTHON+=	src/calibre/library/server/xml.py
FIX_PYTHON+=	src/calibre/library/test.py
FIX_PYTHON+=	src/calibre/libunzip.py
FIX_PYTHON+=	src/calibre/manual/custom.py
FIX_PYTHON+=	src/calibre/manual/epub.py
FIX_PYTHON+=	src/calibre/manual/plugin_examples/helloworld/__init__.py
FIX_PYTHON+=	src/calibre/manual/plugin_examples/interface_demo/__init__.py
FIX_PYTHON+=	src/calibre/manual/plugin_examples/interface_demo/config.py
FIX_PYTHON+=	src/calibre/manual/plugin_examples/interface_demo/main.py
FIX_PYTHON+=	src/calibre/manual/plugin_examples/interface_demo/ui.py
FIX_PYTHON+=	src/calibre/manual/template_ref_generate.py
FIX_PYTHON+=	src/calibre/test_build.py
FIX_PYTHON+=	src/calibre/trac/bzr_commit_plugin.py
FIX_PYTHON+=	src/calibre/translations/msgfmt.py
FIX_PYTHON+=	src/calibre/utils/__init__.py
FIX_PYTHON+=	src/calibre/utils/browser.py
FIX_PYTHON+=	src/calibre/utils/complete.py
FIX_PYTHON+=	src/calibre/utils/config_base.py
FIX_PYTHON+=	src/calibre/utils/date.py
FIX_PYTHON+=	src/calibre/utils/fonts/__init__.py
FIX_PYTHON+=	src/calibre/utils/html2text.py
FIX_PYTHON+=	src/calibre/utils/icu.py
FIX_PYTHON+=	src/calibre/utils/ipc/__init__.py
FIX_PYTHON+=	src/calibre/utils/ipc/job.py
FIX_PYTHON+=	src/calibre/utils/ipc/launch.py
FIX_PYTHON+=	src/calibre/utils/ipc/proxy.py
FIX_PYTHON+=	src/calibre/utils/ipc/server.py
FIX_PYTHON+=	src/calibre/utils/ipc/worker.py
FIX_PYTHON+=	src/calibre/utils/localization.py
FIX_PYTHON+=	src/calibre/utils/magick/__init__.py
FIX_PYTHON+=	src/calibre/utils/magick/draw.py
FIX_PYTHON+=	src/calibre/utils/magick/generate.py
FIX_PYTHON+=	src/calibre/utils/mem.py
FIX_PYTHON+=	src/calibre/utils/network.py
FIX_PYTHON+=	src/calibre/utils/ordered_dict.py
FIX_PYTHON+=	src/calibre/utils/osx_symlinks.py
FIX_PYTHON+=	src/calibre/utils/pdftk.py
FIX_PYTHON+=	src/calibre/utils/podofo/__init__.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/__init__.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/console.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/controller.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/formatter.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/history.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/interpreter.py
FIX_PYTHON+=	src/calibre/utils/pyconsole/main.py
FIX_PYTHON+=	src/calibre/utils/recycle_bin.py
FIX_PYTHON+=	src/calibre/utils/resources.py
FIX_PYTHON+=	src/calibre/utils/search_query_parser.py
FIX_PYTHON+=	src/calibre/utils/sftp.py
FIX_PYTHON+=	src/calibre/utils/sigil.py
FIX_PYTHON+=	src/calibre/utils/text2int.py
FIX_PYTHON+=	src/calibre/utils/titlecase.py
FIX_PYTHON+=	src/calibre/utils/wmf/__init__.py
FIX_PYTHON+=	src/calibre/utils/wmf/parse.py
FIX_PYTHON+=	src/calibre/web/feeds/__init__.py
FIX_PYTHON+=	src/calibre/web/feeds/feedparser.py
FIX_PYTHON+=	src/calibre/web/feeds/input.py
FIX_PYTHON+=	src/calibre/web/feeds/recipes/__init__.py
FIX_PYTHON+=	src/calibre/web/feeds/recipes/collection.py
FIX_PYTHON+=	src/calibre/web/feeds/recipes/model.py
FIX_PYTHON+=	src/calibre/web/feeds/templates.py
FIX_PYTHON+=	src/calibre/web/fetch/simple.py
FIX_PYTHON+=	src/calibre/web/jsbrowser/__init__.py
FIX_PYTHON+=	src/calibre/web/jsbrowser/browser.py
FIX_PYTHON+=	src/calibre/web/jsbrowser/forms.py
FIX_PYTHON+=	src/calibre/web/jsbrowser/login.py
FIX_PYTHON+=	src/calibre/web/jsbrowser/test.py
FIX_PYTHON+=	src/templite/__init__.py

SUBST_CLASSES+=		prefix
SUBST_SED.prefix=	-e "s,^QMAKE =.*,QMAKE = '${PREFIX}/qt4/bin/qmake',"
SUBST_MESSAGE.prefix=	Fixing path to QMAKE
SUBST_STAGE.prefix=	post-patch
SUBST_FILES.prefix=	setup/build_environment.py

# This is a real mess
# This one is for /usr/bin/env python (or even /usr/bin/env Python)
# XXX There are probably more efficient ways to creat the FIX_PYTHON list.
SUBST_CLASSES+=		path
SUBST_SED.path=		-e "s,\#! */usr/bin/env *[Pp]ython[0-9.]*,\#!${PYTHONBIN},"
SUBST_MESSAGE.path=	Fixing path to python.
SUBST_STAGE.path=	post-patch
SUBST_FILES.path=	setup/install.py ${FIX_PYTHON}

# These ones are for replacing python[0-9*] with PYTHONBIN
REPLACE_PYTHON+=	recipes/animal_politico.recipe
REPLACE_PYTHON+=	recipes/kompiutierra.recipe
REPLACE_PYTHON+=	recipes/trouw.recipe
REPLACE_PYTHON+=	src/calibre/ebooks/markdown/extensions/codehilite.py
REPLACE_PYTHON+=	src/calibre/ebooks/markdown/extensions/headerid.py
REPLACE_PYTHON+=	src/calibre/ebooks/markdown/extensions/meta.py
REPLACE_PYTHON+=	src/calibre/ebooks/metadata/odt.py
REPLACE_PYTHON+=	src/calibre/utils/smartypants.py
REPLACE_PYTHON+=	src/calibre/utils/wordcount.py
REPLACE_PYTHON+=	src/odf/element.py
REPLACE_PYTHON+=	src/odf/elementtypes.py
REPLACE_PYTHON+=	src/odf/load.py
REPLACE_PYTHON+=	src/odf/manifest.py
REPLACE_PYTHON+=	src/odf/odf2xhtml.py
REPLACE_PYTHON+=	src/odf/odfmanifest.py
REPLACE_PYTHON+=	src/odf/thumbnail.py
REPLACE_PYTHON+=	src/odf/userfield.py

MAKE_ENV+=		FC_INC_DIR=${BUILDLINK_PREFIX.fontconfig}/include/fontconfig
MAKE_ENV+=		FC_LIB_DIR=${BUILDLINK_PREFIX.fontconfig}/lib
MAKE_ENV+=		PODOFO_INC_DIR=${BUILDLINK_PREFIX.podofo}/include/podofo
MAKE_ENV+=		PODOFO_LIB_DIR=${BUILDLINK_PREFIX.podofo}/lib
#MAKE_ENV+=		XDG_UTILS_DEBUG_LEVEL=100

# Let's depend on the ones we have in pkgsrc instead of the bundled ones.
pre-configure:
	cd ${WRKSRC} && rm -rf src/cherrypy src/pyPdf

post-install:
	cd ${WRKSRC}/recipes && pax -wr -pma *.recipe \
	    ${DESTDIR}${PREFIX}/share/calibre/recipes
	cd ${WRKSRC} && pax -wr -pma Changelog* README \
	    COPYRIGHT INSTALL LICENSE.* \
	    ${DESTDIR}${PREFIX}/share/doc/calibre

.include "../../lang/python/application.mk"
.include "../../databases/sqlite3/buildlink3.mk"
.include "../../devel/chmlib/buildlink3.mk"
BUILDLINK_API_DEPENDS.libusb+=	libusb>=0.1.12
.include "../../devel/libusb/buildlink3.mk"
.include "../../fonts/fontconfig/buildlink3.mk"
BUILDLINK_API_DEPENDS.ImageMagick+=	ImageMagick>=6.5.9
.include "../../graphics/ImageMagick/buildlink3.mk"
BUILDLINK_API_DEPENDS.pyimaging+=	${PYPKGPREFIX}-imaging>=1.1.6
.include "../../graphics/py-imaging/buildlink3.mk"
BUILDLINK_API_DEPENDS.libwmf+=	libwmf>=0.2.8
.include "../../graphics/libwmf/buildlink3.mk"
.include "../../lang/python/egg.mk"
_PYSETUPTOOLSINSTALLARGS=	# empty
# Get rid of --root=${DESTDIR}, use our own version from above instead.
# because the setup.py is not the standard one and behaves differently.
_PYSETUPINSTALLARGS=	${PYSETUPINSTALLARGS} ${PYSETUPOPTARGS} ${_PYSETUPTOOLSINSTALLARGS}
#.include "../../lang/python/extension.mk"
.include "../../print/podofo/buildlink3.mk"
# ??? BUILDLINK_API_DEPENDS.podofo+=	podofo>=0.8.2
.include "../../print/poppler-includes/buildlink3.mk"
.include "../../print/poppler/buildlink3.mk"
BUILDLINK_API_DEPENDS.poppler-qt4+=	poppler-qt4>=0.12.0
.include "../../print/poppler-qt4/buildlink3.mk"
.include "../../sysutils/desktop-file-utils/desktopdb.mk"
.include "../../sysutils/hal/buildlink3.mk"
BUILDLINK_API_DEPENDS.py-dbus+=	${PYPKGPREFIX}-dbus>=0.82.2
.include "../../sysutils/py-dbus/buildlink3.mk"
.include "../../textproc/icu/buildlink3.mk"
.include "../../databases/shared-mime-info/mimedb.mk"
.include "../../textproc/py-elementtree/buildlink3.mk"
.include "../../x11/py-sip/buildlink3.mk"
BUILDLINK_API_DEPENDS.py-qt4+=	${PYPKGPREFIX}-qt4>=4.7.0
.include "../../x11/py-qt4/buildlink3.mk"
BUILDLINK_API_DEPENDS.qt4-tools+=	qt4-tools>=4.7.0
.include "../../x11/qt4-tools/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
