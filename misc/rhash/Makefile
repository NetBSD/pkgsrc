# $NetBSD: Makefile,v 1.12 2019/12/15 14:25:53 adam Exp $

DISTNAME=	rhash-1.3.9
CATEGORIES=	security
MASTER_SITES=	${MASTER_SITE_GITHUB:=rhash/}
GITHUB_PROJECT=	RHash
GITHUB_TAG=	v${PKGVERSION_NOREV}

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	https://github.com/rhash/RHash
COMMENT=	Calculate/check CRC32, MD5, SHA1, GOST, TTH, BTIH or other hash sums
LICENSE=	mit

WRKSRC=			${WRKDIR}/${DISTNAME:S/rh/RH/}
HAS_CONFIGURE=		yes
USE_GCC_RUNTIME=	yes
CONFIGURE_ARGS+=	--disable-symlinks
CONFIGURE_ARGS+=	--disable-openssl-runtime
CONFIGURE_ARGS+=	--enable-lib-shared
CONFIGURE_ARGS+=	--enable-lib-static
CONFIGURE_ARGS+=	--enable-openssl
CONFIGURE_ARGS+=	--extra-cflags=-I${PREFIX}/include\ ${CFLAGS:Q}
CONFIGURE_ARGS+=	--extra-ldflags=-L${PREFIX}/lib\ -Wl,-R${PREFIX}/lib\ ${LDFLAGS:Q}
CONFIGURE_ARGS+=	--mandir=${PREFIX}/${PKGMANDIR}
CONFIGURE_ARGS+=	--prefix=${PREFIX}
CONFIGURE_ARGS+=	--sysconfdir=${PKG_SYSCONFDIR}
INSTALL_TARGET=		install install-pkg-config
INSTALLATION_DIRS=	share/examples/rhash
TEST_TARGET=		test

CONF_FILES+=	${PREFIX}/share/examples/rhash/rhashrc ${PKG_SYSCONFDIR}/rhashrc

post-install:
	${MV} ${DESTDIR}${PKG_SYSCONFDIR}/rhashrc ${DESTDIR}${PREFIX}/share/examples/rhash/rhashrc

.include "../../devel/gettext-lib/buildlink3.mk"
.include "../../security/openssl/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
