--- ../libipsec/pfkey_dump.c-	Sat Jul 12 18:56:47 2003
+++ ../libipsec/pfkey_dump.c	Sat Jul 12 18:57:15 2003
@@ -352,7 +352,9 @@
 	char pbuf[NI_MAXSERV];
 	caddr_t mhp[SADB_EXT_MAX + 1];
 	struct sadb_address *m_saddr, *m_daddr;
+#ifdef SADB_X_EXT_TAG
 	struct sadb_x_tag *m_tag;
+#endif
 	struct sadb_x_policy *m_xpl;
 	struct sadb_lifetime *m_lftc = NULL, *m_lfth = NULL;
 	struct sockaddr *sa;
@@ -370,7 +372,9 @@
 
 	m_saddr = (struct sadb_address *)mhp[SADB_EXT_ADDRESS_SRC];
 	m_daddr = (struct sadb_address *)mhp[SADB_EXT_ADDRESS_DST];
+#ifdef SADB_X_EXT_TAG
 	m_tag = (struct sadb_x_tag *)mhp[SADB_X_EXT_TAG];
+#endif
 	m_xpl = (struct sadb_x_policy *)mhp[SADB_X_EXT_POLICY];
 	m_lftc = (struct sadb_lifetime *)mhp[SADB_EXT_LIFETIME_CURRENT];
 	m_lfth = (struct sadb_lifetime *)mhp[SADB_EXT_LIFETIME_HARD];
@@ -425,8 +429,10 @@
 		str_upperspec(m_saddr->sadb_address_proto, sport, dport);
 	}
 
+#ifdef SADB_X_EXT_TAG
 	if (m_tag)
 		printf("tagged \"%s\" ", m_tag->sadb_x_tag_name);
+#endif
 
 	/* policy */
     {
