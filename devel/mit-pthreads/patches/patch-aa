$NetBSD: patch-aa,v 1.6 1998/08/07 10:40:26 agc Exp $

--- config/Makefile.in	1997/10/13 10:47:39	1.1
+++ config/Makefile.in	1997/10/13 10:47:51
@@ -29,7 +29,7 @@
 # pathname for srcdir here, and live with it.
 srcdir = $(srctop)
 
-beforeinstall:: install-dirs
+beforeinstall: install-dirs
 
 .include "${srcdir}/pthreads/Makefile.inc"
 .include "${srcdir}/stdlib/Makefile.inc"
Note that the context for this next patch is set to 2, to avoid the Id line
- agc
*** machdep/engine-i386-netbsd-1.0.c	1997/10/13 10:50:59	1.1
--- machdep/engine-i386-netbsd-1.0.c	1997/10/13 10:53:31
***************
*** 42,45 ****
--- 42,47 ----
  #endif
  
+ 
+ #include "config.h"
  #include <sys/types.h>
  #include <sys/socket.h>
***************
*** 217,218 ****
--- 219,229 ----
  }  
  
+ #if defined(HAVE_SYSCALL_GETDENTS)
+ /* ==========================================================================
+  * machdep_sys_getdirentries()
+  */
+ int machdep_sys_getdirentries(int fd, char * buf, int len, int * seek)
+ {
+ 	return(machdep_sys_getdents(fd, buf, len));
+ }
+ #endif
--- config/configure	1997/11/13 13:08:00	1.1
+++ config/configure	1997/11/13 13:10:29
@@ -1049,7 +1049,7 @@
 name=$host_cpu-$host_os
 
 case $host in
-    alpha-*-netbsd1.1* | alpha-*-netbsd1.2*)
+    alpha-*-netbsd1.1* | alpha-*-netbsd1.2* | alpha-*-netbsd1.3*)
 	name=alpha-netbsd-1.1
 	sysincludes=netbsd-1.1
 	except="fork lseek pipe sigsuspend sigprocmask"
@@ -1092,7 +1092,7 @@
 EOF
 
 	;;
-	sparc-*-netbsd1.0A | sparc-*-netbsd1.1* | sparc-*-netbsd1.2*)
+	sparc-*-netbsd1.0A | sparc-*-netbsd1.1* | sparc-*-netbsd1.2* | sparc-*-netbsd1.3*)
     name=sparc-sunos-4.1.3
     sysincludes=netbsd-1.0
     syscall=sparc-netbsd-1.1
@@ -1112,7 +1112,7 @@
         syscall=i386-bsdi-2.0
         except="fork lseek sigsuspend"
 		;;
-    i386-*-netbsd1.1* | i386-*-netbsd1.2*)
+    i386-*-netbsd1.1* | i386-*-netbsd1.2* | i386-*-netbsd1.3*)
 	name=i386-netbsd-1.0
 	sysincludes=netbsd-1.1
 	syscall=i386-netbsd-1.1
--- config/configure.in	1997/11/13 13:08:00	1.1
+++ config/configure.in	1997/11/13 13:09:32
@@ -124,7 +124,7 @@
 name=$host_cpu-$host_os
 
 case $host in
-    alpha-*-netbsd1.1* | alpha-*-netbsd1.2*)
+    alpha-*-netbsd1.1* | alpha-*-netbsd1.2* | alpha-*-netbsd1.3*)
 	name=alpha-netbsd-1.1
 	sysincludes=netbsd-1.1
 	except="fork lseek pipe sigsuspend sigprocmask"
@@ -158,7 +158,7 @@
 	AC_DEFINE(LD_LINKS_STATIC_DATA)
 	AC_DEFINE(BROKEN_SIGNALS)
 	;;
-	sparc-*-netbsd1.0A | sparc-*-netbsd1.1* | sparc-*-netbsd1.2*)
+	sparc-*-netbsd1.0A | sparc-*-netbsd1.1* | sparc-*-netbsd1.2* | sparc-*-netbsd1.3*)
     name=sparc-sunos-4.1.3
     sysincludes=netbsd-1.0
     syscall=sparc-netbsd-1.1
@@ -178,7 +178,7 @@
         syscall=i386-bsdi-2.0
         except="fork lseek sigsuspend"
 		;;
-    i386-*-netbsd1.1* | i386-*-netbsd1.2*)
+    i386-*-netbsd1.1* | i386-*-netbsd1.2* | i386-*-netbsd1.3*)
 	name=i386-netbsd-1.0
 	sysincludes=netbsd-1.1
 	syscall=i386-netbsd-1.1
*** /dev/null	Thu Jan  8 12:58:03 1998
--- shlib_version	Thu Jan  8 15:44:03 1998
***************
*** 0 ****
--- 1,2 ----
+ major=1
+ minor=60
--- machdep/syscall-i386-netbsd-1.1.S	1998/03/09 00:14:35	1.1
+++ machdep/syscall-i386-netbsd-1.1.S	1998/03/09 00:16:17
@@ -160,3 +160,19 @@
 	xorl %eax,%eax
 	ret
 
+
+/* ==========================================================================
+ * machdep_sys_fstat()
+ */
+        .globl _machdep_sys_fstat;              
+                                                                        
+_machdep_sys_fstat:;                            
+
+	movl $(SYS___fstat13), %eax;            
+	.byte 0x9a; .long 0; .word 7;   
+	cmpl $0, %edx
+	je   2f
+	movl $0, %eax
+2:      
+        ret                                                    
+
