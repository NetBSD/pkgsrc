$NetBSD: patch-al,v 1.5 2004/04/01 18:34:27 jmmv Exp $

--- sysdeps/freebsd/prockernel.c.orig	2004-03-11 03:23:52.000000000 +0100
+++ sysdeps/freebsd/prockernel.c
@@ -228,6 +228,9 @@ glibtop_get_proc_kernel_p (glibtop *serv
 #if defined(__m68k__)
 			buf->kstk_esp = (u_int64_t) pcb.pcb_usp;
 			buf->kstk_eip = (u_int64_t) 0;
+#elif defined(__x86_64__)
+			buf->kstk_esp = (u_int64_t) pcb.pcb_usersp;
+			buf->kstk_eip = (u_int64_t) 0;
 #elif (defined(__arm32__) || defined(__powerpc__))
 			buf->kstk_esp = (u_int64_t) pcb.pcb_sp;
 			buf->kstk_eip = (u_int64_t) 0;
