$NetBSD: patch-ac,v 1.2 2006/08/06 16:30:40 tron Exp $

--- configure.orig	2006-07-27 19:53:44.000000000 +0100
+++ configure	2006-08-06 15:34:25.000000000 +0100
@@ -21500,7 +21500,7 @@
   FIND_PROC="$PS \$\$PID | grep -v grep | grep \$\$MYSQLD > /dev/null"
 else
   case $SYSTEM_TYPE in
-    *freebsd*)
+    *freebsd*|*dragonfly*)
       FIND_PROC="$PS p \$\$PID | grep -v grep | grep \$\$MYSQLD > /dev/null"
       ;;
     *darwin*)
@@ -24458,13 +24458,13 @@
   :
 else
 
-echo "$as_me:$LINENO: checking for sem_init in -lposix4" >&5
-echo $ECHO_N "checking for sem_init in -lposix4... $ECHO_C" >&6
+echo "$as_me:$LINENO: checking for sem_init in -lrt" >&5
+echo $ECHO_N "checking for sem_init in -lrt... $ECHO_C" >&6
 if test "${ac_cv_lib_posix4_sem_init+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lposix4  $LIBS"
+LIBS="-lrt  $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -24527,7 +24527,7 @@
 #define HAVE_LIBPOSIX4 1
 _ACEOF
 
-  LIBS="-lposix4 $LIBS"
+  LIBS="-lrt $LIBS"
 
 fi
 
@@ -25792,6 +25792,10 @@
       MAX_C_OPTIMIZE="-O"
     fi
     ;;
+  *dragonfly*)
+  	CXXFLAGS="$CXXFLAGS -DMYSQLD_NET_RETRY_COUNT=1000000"
+   ;;
+
   *freebsd*)
     { echo "$as_me:$LINENO: WARNING: Adding fix for interrupted reads" >&5
 echo "$as_me: WARNING: Adding fix for interrupted reads" >&2;}
@@ -39038,8 +39042,8 @@
         OPENSSL_INCLUDE=-I$incs
       fi
       # Test for libssl using all known library file endings
-      if test -f $d/libssl.a || test -f $d/libssl.so || \
-         test -f $d/libssl.sl || test -f $d/libssl.dylib ; then
+      if test -f $libs/libssl.a || test -f $libs/libssl.so || \
+         test -f $libs/libssl.sl || test -f $libs/libssl.dylib ; then
         OPENSSL_LIB=$libs
       fi
       ;;
@@ -39377,7 +39381,7 @@
 main ()
 {
 
-		char res= *(*rl_completion_entry_function)(0,0);
+		char res= (*rl_completion_entry_function)(0,0);
 		completion_matches(0,0);
 
   ;
