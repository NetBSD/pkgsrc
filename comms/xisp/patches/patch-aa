$NetBSD: patch-aa,v 1.7 2002/09/21 23:17:25 jlam Exp $

--- Makefile.orig	Thu Aug 26 08:08:51 1999
+++ Makefile	Wed Apr 17 14:55:31 2002
@@ -8,11 +8,11 @@
 #  Compilation/installation vars (global for all following sections) |
 #=====================================================================
 #
-PREFIX     = /usr/local
-X11PREFIX  = /usr/X11R6
-INCX11     = $(X11PREFIX)/include
-LIBX11     = $(X11PREFIX)/lib
-INCFORMS   = $(X11PREFIX)/include
+#PREFIX     = /usr/local
+#X11PREFIX  = /usr/X11R6
+INCX11     = $(X11BASE)/include
+LIBX11     = $(X11BASE)/lib
+INCFORMS   = $(X11PREFIX)/include/X11
 LIBFORMS   = $(X11PREFIX)/lib
 MODEM_DEV  = modem
 MODEM_PATH = /dev/$(MODEM_DEV)
@@ -24,25 +24,25 @@
 # Normal (i.e. SuSE-6.x) vars; for SuSE-5.x use the lines which
 # DO NOT include -lcrypt in EXTRALIBS and -DGLIBC2 in EXTRADEFS.
 #----------------------------------------------------------------
-BINX11     = $(X11PREFIX)/bin
-USRLOCAL   = $(PREFIX)/bin
-SBINDIR    = /usr/sbin
-VARRUN     = /var/run
-USRLIBPPP  = /etc/ppp
-OPTSDIR    = /etc/ppp
-MANDIR     = $(X11PREFIX)/man/man1
-ETCPPP     = /etc/ppp
-INSTPPPDIR = $(ETCPPP)
-DESTDIR    = 
-GROUP      = uucp
-GCCFLAGS   = -Wall -O
-EXTRADEFS  = -DMODEM_DEVICE=\"$(MODEM_PATH)\" -DGLIBC2
+#BINX11     = $(X11PREFIX)/bin
+#USRLOCAL   = $(PREFIX)/bin
+#SBINDIR    = /usr/sbin
+#VARRUN     = /var/run
+#USRLIBPPP  = /etc/ppp
+#OPTSDIR    = /etc/ppp
+#MANDIR     = $(X11PREFIX)/man/man1
+#ETCPPP     = /etc/ppp
+#INSTPPPDIR = $(ETCPPP)
+#DESTDIR    = 
+#GROUP      = uucp
+#GCCFLAGS   = -Wall -O
+#EXTRADEFS  = -DMODEM_DEVICE=\"$(MODEM_PATH)\" -DGLIBC2
 #EXTRADEFS  = -DMODEM_DEVICE=\"$(MODEM_PATH)\"
-EXTRALIBS  = -lcrypt
+#EXTRALIBS  = -lcrypt
 #EXTRALIBS  = 
-LINKX11    = 
-LINKFORMS  = -L$(LIBFORMS) -lforms
-INSTALL    = install
+#LINKX11    = 
+#LINKFORMS  = -L$(LIBFORMS) -lforms
+#INSTALL    = install
 #
 # Debian vars (if your Debian distribution is relatively
 # old and does not use glibc2, use the lines which DO NOT
@@ -166,24 +166,24 @@
 #
 # NetBSD vars
 #-------------
-#BINX11     = $(X11PREFIX)/bin
-#USRLOCAL   = $(BINX11)
-#SBINDIR    = /usr/sbin
-#VARRUN     = /var/run
-#USRLIBPPP  = $(PREFIX)/libexec
-#MANDIR     = $(PREFIX)/man/man1
-#ETCPPP     = /etc/ppp
-#OPTSDIR    = $(ETCPPP)
+BINX11     = $(X11PREFIX)/bin
+USRLOCAL   = $(BINX11)
+SBINDIR    = /usr/sbin
+VARRUN     = /var/run
+USRLIBPPP  = $(PREFIX)/libexec
+MANDIR     = $(PREFIX)/man/man1
+ETCPPP     = /etc/ppp
+OPTSDIR    = $(ETCPPP)
 #INSTPPPDIR = $(ETCPPP)
-##INSTPPPDIR = $(PREFIX)/share/examples/xisp
-#DESTDIR    = 
-#GROUP      = dialer
-#GCCFLAGS   = -Wall -O
-#EXTRADEFS  = -DMODEM_DEVICE=\"$(MODEM_PATH)\" -DHAVE_STRERROR
-#EXTRALIBS  = -lcrypt
-#LINKX11    = -Wl,-R$(LIBX11)
-#LINKFORMS  = -L$(LIBFORMS) -lforms
-#INSTALL    = /usr/bin/install
+INSTPPPDIR = $(PREFIX)/share/examples/xisp
+DESTDIR    = 
+GROUP      = dialer
+GCCFLAGS   = -Wall -O
+EXTRADEFS  = -DMODEM_DEVICE=\"$(MODEM_PATH)\" -DHAVE_STRERROR
+EXTRALIBS  = -lcrypt
+LINKX11    = -Wl,-R$(LIBX11) -Wl,-R$(LOCALBASE)/lib
+LINKFORMS  = -L$(LIBFORMS) -L$(LOCALBASE)/lib -lforms -ljpeg -lXpm
+INSTALL    = /usr/bin/install
 #
 # FreeBSD vars
 #-------------
@@ -261,16 +261,16 @@
 	gcc $(GCCOPTS) -c network.c
 
 xispdial: xispdial.c common.h version.h
-	gcc $(GCCOPTS) -o xispdial xispdial.c
+	gcc $(GCCOPTS) $(LINKX11) -o xispdial xispdial.c
 
 xisprccv: xisprccv.o pcode.o
-	gcc -o xisprccv xisprccv.o pcode.o $(EXTRALIBS) -lm
+	gcc -o xisprccv xisprccv.o pcode.o $(EXTRALIBS) $(LINKX11) -lm
 
 xisprccv.o: xisprccv.c common.h version.h pcode.h logs.h
 	gcc $(GCCOPTS) -c xisprccv.c
 
 xispterm: xispterm.h xispterm.c
-	gcc $(GCCOPTS) -I$(INCX11) -I$(INCFORMS) -o xispterm xispterm.c $(EXTRALIBS) -L$(LIBX11) $(LINKFORMS) -lX11 -lm
+	gcc $(GCCOPTS) $(LINKX11) -I$(INCX11) -I$(INCFORMS) -o xispterm xispterm.c $(EXTRALIBS) -L$(LIBX11) $(LINKFORMS) -lX11 -lm
 
 rcio.o: rcio.h rcio.c common.h version.h
 	gcc $(GCCOPTS) -c rcio.c
@@ -279,7 +279,7 @@
 	gcc $(GCCOPTS) -c logs.c
 
 xispid: xispid.c
-	gcc $(GCCOPTS) -o xispid xispid.c
+	gcc $(GCCOPTS) $(LINKX11) -o xispid xispid.c
 
 install: xisp xispdial xisprccv xispterm xispid
 	if [ ! -d $(DESTDIR)$(BINX11) ]; then $(INSTALL) -d $(DESTDIR)$(BINX11); fi
